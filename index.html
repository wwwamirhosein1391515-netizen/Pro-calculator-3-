<!DOCTYPE html>
<html lang="fa" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Amirhosein & Abolfazl Professional Calculator</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdn.jsdelivr.net/gh/rastikerdar/vazirmatn@v33.003/Vazirmatn-font-face.css" rel="stylesheet" type="text/css" />
    <script>
        tailwind.config = {
            darkMode: 'class',
            theme: {
                extend: {
                    fontFamily: {
                        sans: ['Vazirmatn', 'Tahoma', 'Segoe UI', 'sans-serif'],
                        mono: ['Tahoma', 'sans-serif'],
                        cursive: ['Brush Script MT', 'cursive'],
                    },
                    colors: {
                        glass: {
                            100: 'rgba(255, 255, 255, 0.1)',
                            200: 'rgba(255, 255, 255, 0.2)',
                            300: 'rgba(255, 255, 255, 0.3)',
                            border: 'rgba(255, 255, 255, 0.4)',
                        }
                    },
                    boxShadow: {
                        'glass': '0 8px 32px 0 rgba(31, 38, 135, 0.15)',
                        'glass-inset': 'inset 0 0 20px rgba(255, 255, 255, 0.3)',
                        'glow': '0 0 20px rgba(167, 139, 250, 0.5)',
                    },
                    animation: {
                        'float': 'float 6s ease-in-out infinite',
                        'blob': 'blob 7s infinite',
                        'fade-in-up': 'fadeInUp 1s ease-out forwards',
                        'rainbow': 'rainbow 5s linear infinite',
                    },
                    keyframes: {
                        float: {
                            '0%, 100%': { transform: 'translateY(0)' },
                            '50%': { transform: 'translateY(-10px)' },
                        },
                        blob: {
                            '0%': { transform: 'translate(0px, 0px) scale(1)' },
                            '33%': { transform: 'translate(30px, -50px) scale(1.1)' },
                            '66%': { transform: 'translate(-20px, 20px) scale(0.9)' },
                            '100%': { transform: 'translate(0px, 0px) scale(1)' },
                        },
                        fadeInUp: {
                            '0%': { opacity: '0', transform: 'translateY(20px)' },
                            '100%': { opacity: '1', transform: 'translateY(0)' },
                        },
                        rainbow: {
                            '0%': { filter: 'hue-rotate(0deg)' },
                            '100%': { filter: 'hue-rotate(360deg)' }
                        }
                    }
                }
            }
        }
    </script>
    <style>
        body {
            background: linear-gradient(-45deg, #e0e0e0, #c0c0c0, #a0a0a0, #d0d0d0);
            background-size: 400% 400%;
            animation: gradient-shift 15s ease infinite;
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            overflow-x: hidden;
            font-family: 'Vazirmatn', 'Tahoma', sans-serif;
            transition: background 0.5s ease;
        }

        /* DARK MODE STYLES */
        body.dark-mode {
            background: linear-gradient(-45deg, #0f172a, #1e293b, #111827, #312e81);
            background-size: 400% 400%;
            color: #e2e8f0;
        }
        body.dark-mode .glass-panel {
            background: rgba(30, 41, 59, 0.6);
            border: 1px solid rgba(255, 255, 255, 0.1);
        }
        body.dark-mode .btn-bubble {
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.15);
            color: #e2e8f0;
        }
        body.dark-mode .btn-bubble:hover {
            background: rgba(255, 255, 255, 0.2);
        }
        body.dark-mode .btn-op { background: rgba(245, 158, 11, 0.3); color: #fbbf24; }
        body.dark-mode .btn-eq { background: rgba(16, 185, 129, 0.3); color: #34d399; }
        body.dark-mode .btn-ac { background: rgba(244, 63, 94, 0.3); color: #fda4af; }
        body.dark-mode .btn-func { background: rgba(99, 102, 241, 0.2); color: #a5b4fc; }
        body.dark-mode .glass-input {
            background: rgba(0, 0, 0, 0.3);
            border: 1px solid rgba(255, 255, 255, 0.1);
            color: #f8fafc;
        }
        body.dark-mode .text-gray-800, 
        body.dark-mode .text-gray-700, 
        body.dark-mode .text-gray-600 {
            color: #e2e8f0;
        }
        body.dark-mode .nav-pill.active {
            background: rgba(255, 255, 255, 0.2);
            color: white;
        }
        body.dark-mode .menu-dropdown {
            background: rgba(30, 41, 59, 0.9);
            border: 1px solid rgba(255, 255, 255, 0.1);
        }
        body.dark-mode .menu-item { color: #e2e8f0; }
        body.dark-mode .menu-item:hover { background: rgba(255, 255, 255, 0.1); }

        /* Easter Egg Class */
        body.easter-egg-active {
            animation: rainbow 2s linear infinite !important;
        }

        @keyframes gradient-shift {
            0% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
            100% { background-position: 0% 50%; }
        }

        .glass-panel {
            background: rgba(255, 255, 255, 0.25);
            backdrop-filter: blur(40px) saturate(100%);
            -webkit-backdrop-filter: blur(40px) saturate(100%);
            border: 1px solid rgba(255, 255, 255, 0.6);
            box-shadow: 0 20px 50px rgba(0,0,0,0.15);
            transition: background 0.3s ease, border 0.3s ease;
        }

        .btn-bubble {
            background: rgba(255, 255, 255, 0.4);
            border: 1px solid rgba(255, 255, 255, 0.5);
            backdrop-filter: blur(10px);
            transition: all 0.1s cubic-bezier(0.4, 0, 0.2, 1);
            position: relative;
            overflow: hidden;
            font-family: 'Tahoma', 'Vazirmatn', sans-serif;
            font-weight: 600;
            cursor: pointer;
            user-select: none;
            -webkit-tap-highlight-color: transparent;
        }
        
        .btn-bubble:hover {
            background: rgba(255, 255, 255, 0.65);
            transform: translateY(-1px);
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }

        .btn-bubble:active {
            transform: scale(0.92);
            background: rgba(255, 255, 255, 0.85);
            box-shadow: 0 0 10px rgba(255, 255, 255, 0.8), inset 0 2px 5px rgba(0,0,0,0.1);
            transition: all 0.05s ease-out;
        }

        .btn-op { background: rgba(220, 220, 220, 0.4); color: #333; } 
        .btn-eq { background: rgba(100, 100, 100, 0.25); color: #000; border-color: rgba(100, 100, 100, 0.4); }
        .btn-ac { background: rgba(220, 200, 200, 0.4); color: #881337; }
        .btn-func { background: rgba(180, 180, 180, 0.3); color: #4b5563; font-size: 1.1rem; }

        .glass-input {
            background: rgba(255, 255, 255, 0.3);
            border: 1px solid rgba(255, 255, 255, 0.5);
            box-shadow: inset 0 2px 4px rgba(0,0,0,0.05);
            color: #1f2937;
            transition: all 0.3s;
            font-family: 'Tahoma', sans-serif;
        }
        .glass-input:focus {
            background: rgba(255, 255, 255, 0.5);
            border-color: #6b7280;
            outline: none;
            box-shadow: 0 0 15px rgba(200, 200, 200, 0.4);
        }
        
        ::-webkit-scrollbar { width: 0px; background: transparent; }

        .nav-pill {
            position: relative;
            z-index: 10;
        }
        .nav-pill.active {
            background: rgba(255, 255, 255, 0.7);
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
            color: #111;
            font-weight: 700;
        }

        .result-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 1rem;
        }
        .result-item {
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 0.5rem;
            border-radius: 1rem;
            background: rgba(255, 255, 255, 0.4);
            border: 1px solid rgba(255, 255, 255, 0.6);
        }
        body.dark-mode .result-item {
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        /* --- MENU & MODALS --- */
        .glass-menu-btn {
            position: fixed;
            top: 20px;
            left: 20px;
            width: 50px;
            height: 50px;
            border-radius: 50%;
            background: rgba(255, 255, 255, 0.35);
            backdrop-filter: blur(20px);
            border: 1px solid rgba(255, 255, 255, 0.6);
            box-shadow: 0 8px 32px 0 rgba(31, 38, 135, 0.15);
            display: flex;
            justify-content: center;
            align-items: center;
            flex-direction: column;
            gap: 4px;
            cursor: pointer;
            z-index: 100;
            transition: all 0.3s ease;
        }
        .glass-menu-btn:hover {
            transform: scale(1.1);
            background: rgba(255, 255, 255, 0.55);
        }
        .dot {
            width: 5px;
            height: 5px;
            background-color: #333;
            border-radius: 50%;
        }

        .menu-dropdown {
            position: fixed;
            top: 80px;
            left: 20px;
            width: 220px; /* Increased width */
            background: rgba(255, 255, 255, 0.85);
            backdrop-filter: blur(40px);
            border: 1px solid rgba(255, 255, 255, 0.7);
            border-radius: 20px;
            padding: 10px;
            display: flex;
            flex-direction: column;
            gap: 5px;
            box-shadow: 0 10px 40px rgba(0,0,0,0.1);
            opacity: 0;
            visibility: hidden;
            transform: translateY(-20px);
            transition: all 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            z-index: 99;
        }
        .menu-dropdown.show {
            opacity: 1;
            visibility: visible;
            transform: translateY(0);
        }
        .menu-item {
            padding: 10px 15px;
            border-radius: 12px;
            cursor: pointer;
            color: #333;
            font-weight: 600;
            transition: background 0.2s;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        .menu-item:hover {
            background: rgba(255, 255, 255, 0.5);
        }

        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.1);
            backdrop-filter: blur(5px);
            z-index: 200;
            display: flex;
            justify-content: center;
            align-items: center;
            opacity: 0;
            visibility: hidden;
            transition: all 0.3s;
        }
        .modal-overlay.open {
            opacity: 1;
            visibility: visible;
        }
        .modal-content {
            width: 90%;
            max-width: 400px;
            min-height: 400px;
            max-height: 80vh;
            overflow-y: auto;
            transform: scale(0.8);
            transition: all 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275);
        }
        .modal-overlay.open .modal-content {
            transform: scale(1);
        }

        /* Toast Notification */
        #toast {
            position: fixed;
            bottom: 20px;
            left: 50%;
            transform: translateX(-50%) translateY(100px);
            background: rgba(0,0,0,0.8);
            color: white;
            padding: 10px 20px;
            border-radius: 30px;
            z-index: 300;
            transition: transform 0.3s ease;
        }
        #toast.show {
            transform: translateX(-50%) translateY(0);
        }

        /* --- INTRO SCREEN STYLES --- */
        #intro-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: #e0e0e0;
            z-index: 9999;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            transition: opacity 1.2s ease-in-out;
            opacity: 0; /* Hidden initially, controlled by JS */
            pointer-events: none; /* Disable interaction until active */
        }
        
        #intro-overlay.active {
            opacity: 1;
            pointer-events: auto;
        }
        
        .intro-text-style {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif;
            font-weight: 800;
            color: #1a1a1a;
            letter-spacing: -1px;
            opacity: 0;
            transform: translateY(30px);
            transition: all 1.5s cubic-bezier(0.22, 1, 0.36, 1); 
            text-shadow: 0 4px 20px rgba(0,0,0,0.08);
        }

        #intro-hello {
            font-size: 5rem;
            margin-bottom: 0.5rem;
        }
        #intro-sub {
            font-family: 'Vazirmatn', sans-serif;
            font-size: 1.5rem;
            font-weight: 500;
            color: #444;
            transition-delay: 0.3s;
        }
        #intro-special-msg {
            font-family: 'Vazirmatn', sans-serif;
            font-size: 1.5rem;
            font-weight: 700;
            color: #1f2937;
            text-align: center;
            padding: 0 20px;
            margin-bottom: 20px;
            line-height: 1.6;
            max-width: 800px;
        }

        /* --- LOGIN OVERLAY STYLES --- */
        #login-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: #e0e0e0; /* Matches body/intro bg */
            z-index: 10000;
            display: flex;
            justify-content: center;
            align-items: center;
            transition: opacity 1s ease;
        }
        
        /* Force black text for login inputs/button as requested */
        #login-overlay .glass-input {
            color: #000 !important; 
            border-color: rgba(0,0,0,0.2) !important;
            background: rgba(255,255,255,0.4) !important;
        }
        #login-overlay .glass-input::placeholder {
            color: #444 !important;
        }
        #login-overlay h2 {
            color: #000 !important;
        }

        .app-container {
            opacity: 0;
            transition: opacity 1s ease-in;
        }
        .app-visible {
            opacity: 1;
        }
        
        #user-name-badge {
            position: absolute;
            top: 5px; /* MODIFIED: Moved up from 10px to 5px */
            right: 15px; /* MODIFIED: Adjusted right from 20px to 15px */
            font-size: 0.85rem;
            font-weight: 700;
            color: #4b5563; /* Gray-600 */
            padding: 8px 16px;
            border-radius: 9999px;
            background: rgba(255, 255, 255, 0.4);
            border: 1px solid rgba(255, 255, 255, 0.5);
            backdrop-filter: blur(8px);
            z-index: 50;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
        }
        body.dark-mode #user-name-badge {
            color: #e2e8f0;
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.1);
        }
    </style>
</head>
<body class="selection:bg-gray-300 selection:text-gray-900 transition-colors duration-500">

    <!-- LOGIN OVERLAY -->
    <div id="login-overlay">
        <div class="glass-panel p-8 rounded-[2rem] flex flex-col gap-5 w-80 text-center border border-white/60 shadow-2xl">
            <h2 class="text-2xl font-bold font-sans mb-2">Ø®ÙˆØ´ Ø¢Ù…Ø¯ÛŒØ¯</h2>
            <div class="flex flex-col gap-3">
                <input type="text" id="login-fname" class="glass-input w-full h-12 rounded-xl text-center text-lg placeholder-gray-600" placeholder="Ù†Ø§Ù…">
                <input type="text" id="login-lname" class="glass-input w-full h-12 rounded-xl text-center text-lg placeholder-gray-600" placeholder="Ù†Ø§Ù… Ø®Ø§Ù†ÙˆØ§Ø¯Ú¯ÛŒ">
            </div>
            <button onclick="submitLogin()" class="btn-bubble w-full h-12 rounded-xl text-black font-bold text-lg mt-2 shadow-lg hover:bg-white/70 transition-all">ÙˆØ±ÙˆØ¯</button>
        </div>
    </div>

    <!-- INTRO OVERLAY -->
    <div id="intro-overlay">
        <!-- Special Message Container (Hidden by default) -->
        <div id="intro-special-msg" class="intro-text-style hidden"></div>
        
        <div id="intro-hello" class="intro-text-style">Hello</div>
        <div id="intro-sub" class="intro-text-style">Amirhosein And Abolfazl pro calculator</div>
    </div>

    <!-- TOAST NOTIFICATION -->
    <div id="toast">Ù…ØªÙ† Ù¾ÛŒØ§Ù…</div>

    <!-- MAIN APP CONTENT -->
    <div id="main-app-container" class="app-container w-full h-full flex flex-col items-center justify-center relative">
        
        <!-- User Name Badge -->
        <div id="user-name-badge" class="hidden"></div>

        <div class="fixed top-0 left-0 w-full h-full overflow-hidden -z-10 pointer-events-none">
            <div class="absolute top-10 left-10 w-72 h-72 bg-gray-300 rounded-full mix-blend-multiply filter blur-3xl opacity-50 animate-blob dark:bg-slate-700 dark:mix-blend-normal"></div>
            <div class="absolute top-10 right-10 w-72 h-72 bg-slate-200 rounded-full mix-blend-multiply filter blur-3xl opacity-50 animate-blob animation-delay-2000 dark:bg-indigo-900 dark:mix-blend-normal"></div>
            <div class="absolute -bottom-32 left-20 w-72 h-72 bg-gray-400 rounded-full mix-blend-multiply filter blur-3xl opacity-40 animate-blob animation-delay-4000 dark:bg-slate-800 dark:mix-blend-normal"></div>
        </div>

        <!-- MENU BUTTON -->
        <div class="glass-menu-btn" onclick="toggleMenu()">
            <div class="dot bg-gray-800 dark:bg-white"></div>
            <div class="dot bg-gray-800 dark:bg-white"></div>
            <div class="dot bg-gray-800 dark:bg-white"></div>
        </div>

        <!-- DROPDOWN MENU -->
        <div id="main-menu" class="menu-dropdown">
            <div class="menu-item" onclick="openSettings()">âš™ï¸ ØªÙ†Ø¸ÛŒÙ…Ø§Øª</div>
            <div class="menu-item" onclick="openHistory()">ğŸ“œ ØªØ§Ø±ÛŒØ®Ú†Ù‡</div>
            <div class="menu-item" onclick="openConverter()">ğŸ”„ ØªØ¨Ø¯ÛŒÙ„ ÙˆØ§Ø­Ø¯</div>
            <div class="menu-item" onclick="openDiscount()">ğŸ·ï¸ Ù…Ø­Ø§Ø³Ø¨Ù‡ ØªØ®ÙÛŒÙ</div>
            <div class="menu-item" onclick="openBMI()">ğŸ’ª Ø´Ø§Ø®Øµ ØªÙˆØ¯Ù‡ Ø¨Ø¯Ù†ÛŒ</div>
            <div class="menu-item" onclick="openPower()">âš¡ ØªÙˆØ§Ù† Ùˆ Ø±ÛŒØ´Ù‡</div>
            <div class="menu-item" onclick="openAgeCalc()">ğŸ“… Ù…Ø­Ø§Ø³Ø¨Ù‡ Ø³Ù† Ø¯Ù‚ÛŒÙ‚</div>
        </div>

        <!-- SETTINGS MODAL -->
        <div id="settings-modal" class="modal-overlay">
            <div class="modal-content glass-panel rounded-[2rem] p-6 flex flex-col relative">
                <button onclick="closeModal('settings-modal')" class="absolute top-4 left-4 text-gray-600 hover:text-red-500 font-bold text-xl transition-colors dark:text-gray-300">âœ•</button>
                <h2 class="text-xl font-bold text-center mb-6 text-gray-800 dark:text-white">ØªÙ†Ø¸ÛŒÙ…Ø§Øª</h2>
                
                <div id="settings-content-wrapper" class="flex flex-col gap-6">
                    <!-- User Info Section -->
                    <div class="glass-panel rounded-xl p-4 flex flex-col items-center gap-2">
                        <div class="w-16 h-16 rounded-full bg-gray-300/50 flex items-center justify-center text-3xl">ğŸ‘¤</div>
                        <div class="text-sm text-gray-500 dark:text-gray-400">Ú©Ø§Ø±Ø¨Ø± ÙØ¹Ù„ÛŒ</div>
                        <div id="settings-user-name" class="text-lg font-bold text-gray-800 dark:text-white">---</div>
                    </div>

                    <!-- Theme Toggle Section -->
                    <div class="glass-panel rounded-xl p-4 flex items-center justify-between cursor-pointer hover:bg-white/20 transition-all" onclick="toggleTheme()">
                        <span class="text-gray-700 dark:text-gray-200 font-semibold">Ø­Ø§Ù„Øª Ø´Ø¨ (Dark Mode)</span>
                        <div class="relative w-12 h-6 rounded-full bg-gray-400 dark:bg-green-500 transition-colors">
                            <div class="absolute top-1 left-1 bg-white w-4 h-4 rounded-full transition-transform transform dark:translate-x-6"></div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- HISTORY MODAL -->
        <div id="history-modal" class="modal-overlay">
            <div class="modal-content glass-panel rounded-[2rem] p-6 flex flex-col relative">
                <button onclick="closeModal('history-modal')" class="absolute top-4 left-4 text-gray-600 hover:text-red-500 font-bold text-xl transition-colors dark:text-gray-300">âœ•</button>
                <h2 class="text-xl font-bold text-center mb-4 text-gray-800">ØªØ§Ø±ÛŒØ®Ú†Ù‡ Ù…Ø­Ø§Ø³Ø¨Ø§Øª</h2>
                <p class="text-center text-xs text-gray-500 mb-2">Ø¨Ø±Ø§ÛŒ Ú©Ù¾ÛŒ Ø±ÙˆÛŒ Ù†ØªÛŒØ¬Ù‡ Ú©Ù„ÛŒÚ© Ú©Ù†ÛŒØ¯</p>
                <div id="history-list" class="flex flex-col gap-2 overflow-y-auto max-h-[60vh] pr-1">
                    <div class="text-center text-gray-500 py-4">Ù‡Ù†ÙˆØ² Ù…Ø­Ø§Ø³Ø¨Ù‡â€ŒØ§ÛŒ Ø§Ù†Ø¬Ø§Ù… Ù†Ø´Ø¯Ù‡</div>
                </div>
                <button onclick="clearHistory()" class="btn-bubble mt-4 py-2 rounded-xl text-red-700 text-sm font-semibold">Ù¾Ø§Ú© Ú©Ø±Ø¯Ù† ØªØ§Ø±ÛŒØ®Ú†Ù‡</button>
            </div>
        </div>

        <!-- UNIT CONVERTER MODAL -->
        <div id="converter-modal" class="modal-overlay">
            <div class="modal-content glass-panel rounded-[2rem] p-6 flex flex-col relative">
                <button onclick="closeModal('converter-modal')" class="absolute top-4 left-4 text-gray-600 hover:text-red-500 font-bold text-xl transition-colors dark:text-gray-300">âœ•</button>
                <h2 class="text-xl font-bold text-center mb-4 text-gray-800">ØªØ¨Ø¯ÛŒÙ„ ÙˆØ§Ø­Ø¯</h2>
                
                <div class="flex flex-col gap-4">
                    <div>
                        <label class="text-sm text-gray-600 font-semibold mb-1 block">Ù†ÙˆØ¹ ÙˆØ§Ø­Ø¯:</label>
                        <select id="conv-type" onchange="updateConvOptions()" class="glass-input w-full h-10 rounded-xl text-center appearance-none cursor-pointer">
                            <option value="length">Ø·ÙˆÙ„</option>
                            <option value="mass">ÙˆØ²Ù† (Ø¬Ø±Ù…)</option>
                            <option value="temp">Ø¯Ù…Ø§</option>
                        </select>
                    </div>

                    <div>
                        <label class="text-sm text-gray-600 font-semibold mb-1 block">Ù…Ù‚Ø¯Ø§Ø±:</label>
                        <input type="number" id="conv-input" oninput="convertUnits()" class="glass-input w-full h-12 rounded-xl text-center text-lg font-mono" placeholder="0">
                    </div>
                    
                    <div class="flex gap-2 items-center">
                        <select id="conv-from" onchange="convertUnits()" class="glass-input flex-1 h-12 rounded-xl text-center appearance-none cursor-pointer"></select>
                        <span class="text-gray-500 font-bold dark:text-gray-300">Ø¨Ù‡</span>
                        <select id="conv-to" onchange="convertUnits()" class="glass-input flex-1 h-12 rounded-xl text-center appearance-none cursor-pointer"></select>
                    </div>

                    <div class="glass-panel rounded-xl p-4 mt-2 text-center dark:bg-white/10">
                        <div class="text-sm text-gray-500 mb-1">Ù†ØªÛŒØ¬Ù‡:</div>
                        <div id="conv-result" class="text-2xl font-mono font-bold text-gray-800">0</div>
                    </div>
                </div>
            </div>
        </div>

        <!-- DISCOUNT CALCULATOR MODAL -->
        <div id="discount-modal" class="modal-overlay">
            <div class="modal-content glass-panel rounded-[2rem] p-6 flex flex-col relative">
                <button onclick="closeModal('discount-modal')" class="absolute top-4 left-4 text-gray-600 hover:text-red-500 font-bold text-xl transition-colors dark:text-gray-300">âœ•</button>
                <h2 class="text-xl font-bold text-center mb-4 text-gray-800">Ù…Ø­Ø§Ø³Ø¨Ù‡ ØªØ®ÙÛŒÙ</h2>
                <div class="flex flex-col gap-4">
                    <input type="number" id="disc-price" class="glass-input w-full h-12 rounded-xl text-center text-lg font-mono" placeholder="Ù‚ÛŒÙ…Øª Ø§ØµÙ„ÛŒ">
                    <input type="number" id="disc-percent" class="glass-input w-full h-12 rounded-xl text-center text-lg font-mono" placeholder="Ø¯Ø±ØµØ¯ ØªØ®ÙÛŒÙ">
                    <button onclick="calcDiscount()" class="btn-bubble btn-eq h-12 rounded-xl text-lg font-semibold shadow-lg">Ù…Ø­Ø§Ø³Ø¨Ù‡</button>
                    <div id="disc-result" class="glass-panel rounded-xl p-4 mt-2 text-center text-gray-800 dark:text-white font-mono dir-ltr">
                        ---
                    </div>
                </div>
            </div>
        </div>

        <!-- BMI CALCULATOR MODAL -->
        <div id="bmi-modal" class="modal-overlay">
            <div class="modal-content glass-panel rounded-[2rem] p-6 flex flex-col relative">
                <button onclick="closeModal('bmi-modal')" class="absolute top-4 left-4 text-gray-600 hover:text-red-500 font-bold text-xl transition-colors dark:text-gray-300">âœ•</button>
                <h2 class="text-xl font-bold text-center mb-4 text-gray-800">Ø´Ø§Ø®Øµ ØªÙˆØ¯Ù‡ Ø¨Ø¯Ù†ÛŒ (BMI)</h2>
                <div class="flex flex-col gap-4">
                    <input type="number" id="bmi-height" class="glass-input w-full h-12 rounded-xl text-center text-lg font-mono" placeholder="Ù‚Ø¯ (Ø³Ø§Ù†ØªÛŒâ€ŒÙ…ØªØ±)">
                    <input type="number" id="bmi-weight" class="glass-input w-full h-12 rounded-xl text-center text-lg font-mono" placeholder="ÙˆØ²Ù† (Ú©ÛŒÙ„ÙˆÚ¯Ø±Ù…)">
                    <button onclick="calcBMI()" class="btn-bubble btn-eq h-12 rounded-xl text-lg font-semibold shadow-lg">Ù…Ø­Ø§Ø³Ø¨Ù‡ BMI</button>
                    <div id="bmi-result" class="glass-panel rounded-xl p-4 mt-2 text-center text-gray-800 dark:text-white">
                        ---
                    </div>
                </div>
            </div>
        </div>

        <!-- POWER & ROOT MODAL -->
        <div id="power-modal" class="modal-overlay">
            <div class="modal-content glass-panel rounded-[2rem] p-6 flex flex-col relative">
                <button onclick="closeModal('power-modal')" class="absolute top-4 left-4 text-gray-600 hover:text-red-500 font-bold text-xl transition-colors dark:text-gray-300">âœ•</button>
                <h2 class="text-xl font-bold text-center mb-4 text-gray-800">ØªÙˆØ§Ù† Ùˆ Ø±ÛŒØ´Ù‡</h2>
                
                <div class="flex flex-col gap-6">
                    <!-- Power -->
                    <div class="flex flex-col gap-2 border-b border-gray-400/30 pb-4">
                        <label class="text-sm font-semibold text-gray-700">Ø¨Ù‡ ØªÙˆØ§Ù† Ø±Ø³Ø§Ù†Ø¯Ù† (xÊ¸)</label>
                        <div class="flex gap-2">
                            <input type="number" id="pow-base" class="glass-input w-full h-10 rounded-xl text-center font-mono" placeholder="Ù¾Ø§ÛŒÙ‡ (x)">
                            <input type="number" id="pow-exp" class="glass-input w-full h-10 rounded-xl text-center font-mono" placeholder="ØªÙˆØ§Ù† (y)">
                        </div>
                        <button onclick="calcPower()" class="btn-bubble btn-op h-10 rounded-xl">Ù…Ø­Ø§Ø³Ø¨Ù‡ ØªÙˆØ§Ù†</button>
                        <div id="pow-result" class="text-center font-bold text-lg font-mono text-gray-800 dark:text-white">---</div>
                    </div>

                    <!-- Root -->
                    <div class="flex flex-col gap-2">
                        <label class="text-sm font-semibold text-gray-700">Ø±ÛŒØ´Ù‡â€ŒÚ¯ÛŒØ±ÛŒ (â¿âˆšx)</label>
                        <div class="flex gap-2">
                            <input type="number" id="root-base" class="glass-input w-full h-10 rounded-xl text-center font-mono" placeholder="Ø¹Ø¯Ø¯ (x)">
                            <input type="number" id="root-degree" class="glass-input w-full h-10 rounded-xl text-center font-mono" placeholder="ÙØ±Ø¬Ù‡ (n)">
                        </div>
                        <button onclick="calcRoot()" class="btn-bubble btn-op h-10 rounded-xl">Ù…Ø­Ø§Ø³Ø¨Ù‡ Ø±ÛŒØ´Ù‡</button>
                        <div id="root-result" class="text-center font-bold text-lg font-mono text-gray-800 dark:text-white">---</div>
                    </div>
                </div>
            </div>
        </div>

        <!-- AGE CALCULATOR MODAL -->
        <div id="age-modal" class="modal-overlay">
            <div class="modal-content glass-panel rounded-[2rem] p-6 flex flex-col relative">
                <button onclick="closeModal('age-modal')" class="absolute top-4 left-4 text-gray-600 hover:text-red-500 font-bold text-xl transition-colors dark:text-gray-300">âœ•</button>
                <h2 class="text-xl font-bold text-center mb-4 text-gray-800">Ù…Ø­Ø§Ø³Ø¨Ù‡ Ø³Ù† Ø¯Ù‚ÛŒÙ‚</h2>
                <div class="flex flex-col gap-4">
                    <label class="text-sm text-gray-600 dark:text-gray-300 text-center block">ØªØ§Ø±ÛŒØ® ØªÙˆÙ„Ø¯ Ø®ÙˆØ¯ Ø±Ø§ Ø§Ù†ØªØ®Ø§Ø¨ Ú©Ù†ÛŒØ¯ (Ù…ÛŒÙ„Ø§Ø¯ÛŒ):</label>
                    <input type="date" id="age-input" class="glass-input w-full h-12 rounded-xl text-center text-lg font-mono">
                    <button onclick="calcAge()" class="btn-bubble btn-eq h-12 rounded-xl text-lg font-semibold shadow-lg">Ù…Ø­Ø§Ø³Ø¨Ù‡ Ø³Ù†</button>
                    <div id="age-result" class="glass-panel rounded-xl p-4 mt-2 text-center text-gray-800 dark:text-white flex flex-col gap-2">
                        ---
                    </div>
                </div>
            </div>
        </div>

        <header class="mb-6 animate-float mt-10">
            <div class="glass-panel rounded-full px-8 py-3 text-center border-2 border-white/60">
                <h1 class="text-xl md:text-2xl font-bold text-gray-800 dark:text-gray-100 tracking-tight drop-shadow-sm">
                    Amirhosein <span class="text-gray-500 dark:text-gray-400">&</span> Abolfazl
                </h1>
                <p class="text-xs text-gray-600 dark:text-gray-300 font-semibold uppercase tracking-widest mt-1 opacity-90">Ultra Hyper Calculator</p>
            </div>
        </header>

        <main class="w-full max-w-md px-4 pb-10">
            <div class="glass-panel rounded-[3rem] p-6 relative overflow-hidden min-h-[600px] flex flex-col">
                
                <div class="glass-panel rounded-full p-1.5 flex justify-between items-center mb-6 shadow-glass-inset">
                    <button onclick="switchTab('basic')" id="tab-basic" class="nav-pill active flex-1 py-2 rounded-full text-[10px] sm:text-xs font-semibold text-gray-600 transition-all duration-300">Ù¾Ø§ÛŒÙ‡</button>
                    <button onclick="switchTab('fraction')" id="tab-fraction" class="nav-pill flex-1 py-2 rounded-full text-[10px] sm:text-xs font-semibold text-gray-600 transition-all duration-300">Ú©Ø³Ø±</button>
                    <button onclick="switchTab('equation')" id="tab-equation" class="nav-pill flex-1 py-2 rounded-full text-[10px] sm:text-xs font-semibold text-gray-600 transition-all duration-300">Ù…Ø¹Ø§Ø¯Ù„Ù‡</button>
                    <button onclick="switchTab('number')" id="tab-number" class="nav-pill flex-1 py-2 rounded-full text-[10px] sm:text-xs font-semibold text-gray-600 transition-all duration-300">Ø®ÙˆØ§Øµ Ø¹Ø¯Ø¯</button>
                    <button onclick="switchTab('polygon')" id="tab-polygon" class="nav-pill flex-1 py-2 rounded-full text-[10px] sm:text-xs font-semibold text-gray-600 transition-all duration-300">Ú†Ù†Ø¯Ø¶Ù„Ø¹ÛŒ</button>
                    <button onclick="switchTab('triangle')" id="tab-triangle" class="nav-pill flex-1 py-2 rounded-full text-[10px] sm:text-xs font-semibold text-gray-600 transition-all duration-300">Ù…Ø«Ù„Ø«</button>
                </div>

                <div id="app-content" class="flex-1 flex flex-col relative transition-opacity duration-300">
                </div>

            </div>
        </main>
    </div>

    <script>
        // --- State Management ---
        let currentTab = 'basic';
        let displayVal = '0';
        let calcHistory = [];
        let isDarkMode = false;
        let userData = {
            firstName: '',
            lastName: ''
        };

        // --- INIT & FLOW ---
        document.addEventListener('DOMContentLoaded', () => {
            updateConvOptions();
            
            // Check for saved user
            const savedFName = localStorage.getItem('ah_user_fname');
            const savedLName = localStorage.getItem('ah_user_lname');

            if (savedFName && savedLName) {
                userData.firstName = savedFName;
                userData.lastName = savedLName;
                document.getElementById('login-overlay').style.display = 'none'; // Hide Login Immediately
                startIntroSequence();
            } else {
                // Show Login Screen (it's visible by default, so just wait)
            }

            renderBasic();
        });

        // --- LOGIN LOGIC ---
        function submitLogin() {
            const fName = document.getElementById('login-fname').value.trim();
            const lName = document.getElementById('login-lname').value.trim();

            if (!fName || !lName) {
                showToast('Ù„Ø·ÙØ§Ù‹ Ù†Ø§Ù… Ùˆ Ù†Ø§Ù… Ø®Ø§Ù†ÙˆØ§Ø¯Ú¯ÛŒ Ø±Ø§ ÙˆØ§Ø±Ø¯ Ú©Ù†ÛŒØ¯');
                return;
            }

            // Save Data
            localStorage.setItem('ah_user_fname', fName);
            localStorage.setItem('ah_user_lname', lName);
            userData.firstName = fName;
            userData.lastName = lName;

            // Fade out login, start intro
            const loginOverlay = document.getElementById('login-overlay');
            loginOverlay.style.opacity = '0';
            
            setTimeout(() => {
                loginOverlay.style.display = 'none';
                startIntroSequence();
            }, 1000);
        }

        // --- INTRO SEQUENCE ---
        function startIntroSequence() {
            const overlay = document.getElementById('intro-overlay');
            const helloText = document.getElementById('intro-hello');
            const subText = document.getElementById('intro-sub');
            const specialMsg = document.getElementById('intro-special-msg');
            const mainApp = document.getElementById('main-app-container');
            const userBadge = document.getElementById('user-name-badge');

            // --- MODIFIED: CHECK FOR SPECIAL TEACHERS ---
            const specialTeachers = [
                { f: 'Ø­Ø§Ù…Ø¯', l: 'Ù…ÙˆÙ„Ø§ÛŒÛŒ' },
                { f: 'Ø­Ø³ÛŒÙ†', l: 'Ø¨Ø®ØªÛŒØ§Ø±ÛŒ' },
                { f: 'Ù…Ø­Ù…Ø¯', l: 'Ù‚Ø§Ø³Ù…ÛŒ' },
                { f: 'Ù…ØµØ·ÙÛŒ', l: 'Ø´Ø¹Ø¨Ø§Ù†ÛŒ' }
            ];

            const foundTeacher = specialTeachers.find(t => 
                t.f === userData.firstName.trim() && t.l === userData.lastName.trim()
            );

            if (foundTeacher) {
                userBadge.innerText = `Ø§Ø³ØªØ§Ø¯ ${userData.lastName} Ø¹Ø²ÛŒØ²`;
            } else {
                userBadge.innerText = `${userData.firstName} Ø¹Ø²ÛŒØ²`;
            }
            
            userBadge.classList.remove('hidden');

            // Show Intro Overlay
            overlay.classList.add('active');

            // Check for Special User (Abolfazl Hazrati)
            const f = userData.firstName.trim();
            const l = userData.lastName.trim();

            const isAbolfazl = f.includes('Ø§Ø¨ÙˆØ§Ù„ÙØ¶Ù„') || f.toLowerCase().includes('abolfazl');
            const isHazrati = l.includes('Ø­Ø¶Ø±ØªÛŒ') || l.includes('Ø­Ø¶Ø±ØªÛŒ Ø²Ø§Ø¯Ù‡') || l.toLowerCase().includes('hazrati');

            if (isAbolfazl && isHazrati) {
                specialMsg.innerHTML = 'Ø§Ù…ÛŒØ¯ÙˆØ§Ø±Ù… Ø¯Ø± Ù…Ø³Ø§Ø¨Ù‚Ø§Øª Ø§ÙˆÙ„ Ø´ÛŒÙ… Ø§Ø¨ÙˆØ§Ù„ÙØ¶Ù„ Ø­Ø¶Ø±ØªÛŒ Ø¹Ø²ÛŒØ² Ù…Ù…Ù†ÙˆÙ† Ú©Ù‡ Ù¾Ø§ Ø¨Ù‡ Ù¾Ø§Ù… ØªÙ„Ø§Ø´ Ú©Ø±Ø¯ÛŒ ØªØ§ Ø§ÛŒÙ† Ø±Ùˆ Ø¨Ù‡ Ø§ÛŒÙ† Ø¯Ø±Ø¬Ù‡ Ø¨Ø±Ø³ÙˆÙ†ÛŒÙ…';
                specialMsg.classList.remove('hidden');
                
                // Animate Special Msg First
                setTimeout(() => {
                    specialMsg.style.opacity = '1';
                    specialMsg.style.transform = 'translateY(0)';
                }, 300);

                // Animate Hello
                setTimeout(() => {
                    helloText.style.opacity = '1';
                    helloText.style.transform = 'translateY(0)';
                }, 2000); // Delayed a bit more to read the message

                // Animate Subtitle
                setTimeout(() => {
                    subText.style.opacity = '1';
                    subText.style.transform = 'translateY(0)';
                }, 3000);

                // End Intro
                setTimeout(() => {
                    overlay.style.opacity = '0';
                    mainApp.classList.add('app-visible');
                    setTimeout(() => { overlay.style.display = 'none'; }, 1200); 
                }, 6000);

            } else {
                // Normal Flow
                setTimeout(() => {
                    helloText.style.opacity = '1';
                    helloText.style.transform = 'translateY(0)';
                }, 300);

                setTimeout(() => {
                    subText.style.opacity = '1';
                    subText.style.transform = 'translateY(0)';
                }, 1200);

                setTimeout(() => {
                    overlay.style.opacity = '0';
                    mainApp.classList.add('app-visible');
                    setTimeout(() => { overlay.style.display = 'none'; }, 1200); 
                }, 3500);
            }
        }

        // --- MENU & MODAL FUNCTIONS ---
        function toggleMenu() {
            const menu = document.getElementById('main-menu');
            menu.classList.toggle('show');
        }

        window.addEventListener('click', (e) => {
            const menu = document.getElementById('main-menu');
            const btn = document.querySelector('.glass-menu-btn');
            if (!menu.contains(e.target) && !btn.contains(e.target)) {
                menu.classList.remove('show');
            }
        });

        // Toggle Dark Mode
        function toggleTheme() {
            isDarkMode = !isDarkMode;
            document.body.classList.toggle('dark-mode');
        }

        // --- Modal Openers ---
        function closeModal(id) { document.getElementById(id).classList.remove('open'); }
        
        function openSettings() {
            // Populate data
            document.getElementById('settings-user-name').innerText = `${userData.firstName} ${userData.lastName}`;
            
            // --- MODIFIED: ADD ONE-TIME EDIT BUTTON ---
            const editUsed = localStorage.getItem('ah_edit_profile_used');
            const settingsWrapper = document.getElementById('settings-content-wrapper');
            
            // Remove existing button if any to prevent duplicates
            const existingBtn = document.getElementById('btn-reset-profile');
            if(existingBtn) existingBtn.remove();

            if (!editUsed) {
                const btn = document.createElement('button');
                btn.id = 'btn-reset-profile';
                btn.className = 'btn-bubble w-full py-3 rounded-xl text-red-600 font-bold border-red-200 hover:bg-red-50 transition-colors mt-2 text-sm';
                btn.innerText = 'ÙˆÛŒØ±Ø§ÛŒØ´ Ù…Ø´Ø®ØµØ§Øª (ÙÙ‚Ø· ÛŒÚ©Ø¨Ø§Ø±)';
                btn.onclick = resetProfile;
                settingsWrapper.appendChild(btn);
            }

            document.getElementById('settings-modal').classList.add('open');
            document.getElementById('main-menu').classList.remove('show');
        }

        function resetProfile() {
            // Clear user data
            localStorage.removeItem('ah_user_fname');
            localStorage.removeItem('ah_user_lname');
            // Mark as used
            localStorage.setItem('ah_edit_profile_used', 'true');
            // Reload page to show login screen
            location.reload();
        }

        function openHistory() {
            document.getElementById('history-modal').classList.add('open');
            document.getElementById('main-menu').classList.remove('show');
            renderHistoryList();
        }
        function openConverter() {
            document.getElementById('converter-modal').classList.add('open');
            document.getElementById('main-menu').classList.remove('show');
        }
        function openDiscount() {
            document.getElementById('discount-modal').classList.add('open');
            document.getElementById('main-menu').classList.remove('show');
        }
        function openBMI() {
            document.getElementById('bmi-modal').classList.add('open');
            document.getElementById('main-menu').classList.remove('show');
        }
        function openPower() {
            document.getElementById('power-modal').classList.add('open');
            document.getElementById('main-menu').classList.remove('show');
        }
        function openAgeCalc() {
            document.getElementById('age-modal').classList.add('open');
            document.getElementById('main-menu').classList.remove('show');
        }

        // --- History Logic ---
        function addToHistory(expression, result) {
            if (result === 'Error') return;
            calcHistory.unshift({ exp: expression, res: result });
            if (calcHistory.length > 10) calcHistory.pop(); 
        }

        function copyToClipboard(text) {
            navigator.clipboard.writeText(text).then(() => {
                showToast('Ú©Ù¾ÛŒ Ø´Ø¯!');
            }).catch(() => {
                try {
                    const el = document.createElement('textarea');
                    el.value = text;
                    document.body.appendChild(el);
                    el.select();
                    document.execCommand('copy');
                    document.body.removeChild(el);
                    showToast('Ú©Ù¾ÛŒ Ø´Ø¯!');
                } catch(e) {
                    showToast('Ø®Ø·Ø§ Ø¯Ø± Ú©Ù¾ÛŒ');
                }
            });
        }

        function showToast(msg) {
            const toast = document.getElementById('toast');
            toast.innerText = msg;
            toast.classList.add('show');
            setTimeout(() => { toast.classList.remove('show'); }, 2000);
        }

        function renderHistoryList() {
            const list = document.getElementById('history-list');
            if (calcHistory.length === 0) {
                list.innerHTML = '<div class="text-center text-gray-500 py-4">Ù‡Ù†ÙˆØ² Ù…Ø­Ø§Ø³Ø¨Ù‡â€ŒØ§ÛŒ Ø§Ù†Ø¬Ø§Ù… Ù†Ø´Ø¯Ù‡</div>';
                return;
            }
            let html = '';
            calcHistory.forEach(item => {
                html += `
                    <div class="glass-panel p-3 rounded-xl mb-2 flex flex-col items-end border-white/40 cursor-pointer hover:bg-white/20 transition-colors" onclick="copyToClipboard('${item.res}')" title="Ú©Ù¾ÛŒ Ù†ØªÛŒØ¬Ù‡">
                        <span class="text-xs text-gray-500 font-mono dark:text-gray-400">${item.exp}</span>
                        <span class="text-lg font-bold text-gray-800 font-mono dark:text-white">= ${item.res}</span>
                    </div>
                `;
            });
            list.innerHTML = html;
        }

        function clearHistory() {
            calcHistory = [];
            renderHistoryList();
        }

        // --- UNIT CONVERTER LOGIC ---
        const unitData = {
            length: [
                { val: 'm', label: 'Ù…ØªØ± (m)', factor: 1 },
                { val: 'cm', label: 'Ø³Ø§Ù†ØªÛŒâ€ŒÙ…ØªØ± (cm)', factor: 0.01 },
                { val: 'km', label: 'Ú©ÛŒÙ„ÙˆÙ…ØªØ± (km)', factor: 1000 },
                { val: 'inch', label: 'Ø§ÛŒÙ†Ú† (in)', factor: 0.0254 },
                { val: 'ft', label: 'ÙÙˆØª (ft)', factor: 0.3048 }
            ],
            mass: [
                { val: 'kg', label: 'Ú©ÛŒÙ„ÙˆÚ¯Ø±Ù… (kg)', factor: 1000 },
                { val: 'g', label: 'Ú¯Ø±Ù… (g)', factor: 1 },
                { val: 'lb', label: 'Ù¾ÙˆÙ†Ø¯ (lb)', factor: 453.592 },
                { val: 'mesghal', label: 'Ù…Ø«Ù‚Ø§Ù„', factor: 4.6083 },
                { val: 'soot', label: 'Ø³ÙˆØª', factor: 0.001 }
            ],
            temp: [
                { val: 'c', label: 'Ø³Ù„Ø³ÛŒÙˆØ³ (Â°C)' },
                { val: 'f', label: 'ÙØ§Ø±Ù†Ù‡Ø§ÛŒØª (Â°F)' }
            ]
        };

        function updateConvOptions() {
            const type = document.getElementById('conv-type').value;
            const fromSelect = document.getElementById('conv-from');
            const toSelect = document.getElementById('conv-to');
            const data = unitData[type];

            fromSelect.innerHTML = '';
            toSelect.innerHTML = '';

            data.forEach((unit) => {
                const opt1 = document.createElement('option');
                opt1.value = unit.val;
                opt1.text = unit.label;
                fromSelect.add(opt1);

                const opt2 = document.createElement('option');
                opt2.value = unit.val;
                opt2.text = unit.label;
                toSelect.add(opt2);
            });

            if (toSelect.options.length > 1) toSelect.selectedIndex = 1;
            convertUnits();
        }

        function convertUnits() {
            const val = parseFloat(document.getElementById('conv-input').value);
            const type = document.getElementById('conv-type').value;
            const from = document.getElementById('conv-from').value;
            const to = document.getElementById('conv-to').value;
            const resDiv = document.getElementById('conv-result');

            if (isNaN(val)) {
                resDiv.innerText = '0';
                return;
            }

            let result;

            if (type === 'temp') {
                if (from === to) result = val;
                else if (from === 'c' && to === 'f') result = (val * 9/5) + 32;
                else if (from === 'f' && to === 'c') result = (val - 32) * 5/9;
            } else {
                const data = unitData[type];
                const fromUnit = data.find(u => u.val === from);
                const toUnit = data.find(u => u.val === to);
                if (!fromUnit || !toUnit) return;
                // Convert input to base then to target
                const baseValue = val * fromUnit.factor;
                result = baseValue / toUnit.factor;
            }

            let finalRes;
            if (Math.abs(result) < 0.000001 && result !== 0 || Math.abs(result) > 1000000) {
                finalRes = result.toExponential(4);
            } else {
                finalRes = parseFloat(result.toFixed(4));
            }
            resDiv.innerText = finalRes;
        }

        // --- NEW CALCULATORS LOGIC ---

        function calcDiscount() {
            const price = parseFloat(document.getElementById('disc-price').value);
            const percent = parseFloat(document.getElementById('disc-percent').value);
            const resDiv = document.getElementById('disc-result');
            
            if (isNaN(price) || isNaN(percent)) {
                resDiv.innerHTML = '<span class="text-red-600">ÙˆØ±ÙˆØ¯ÛŒ Ù†Ø§Ù‚Øµ</span>';
                return;
            }
            const saving = price * (percent / 100);
            const final = price - saving;
            resDiv.innerHTML = `
                <div>Ù¾Ø±Ø¯Ø§Ø®ØªÛŒ: <span class="font-bold text-xl">${final.toLocaleString()}</span></div>
                <div class="text-sm text-green-600 mt-1">Ø³ÙˆØ¯ Ø´Ù…Ø§: ${saving.toLocaleString()}</div>
            `;
        }

        function calcBMI() {
            const h = parseFloat(document.getElementById('bmi-height').value) / 100; // cm to m
            const w = parseFloat(document.getElementById('bmi-weight').value);
            const resDiv = document.getElementById('bmi-result');

            if (isNaN(h) || isNaN(w) || h <= 0) {
                resDiv.innerHTML = '<span class="text-red-600">ÙˆØ±ÙˆØ¯ÛŒ Ù†Ø§Ù…Ø¹ØªØ¨Ø±</span>';
                return;
            }

            const bmi = w / (h * h);
            let status = '';
            let color = '';

            if(bmi < 18.5) { status = 'Ú©Ù…Ø¨ÙˆØ¯ ÙˆØ²Ù†'; color = 'text-blue-600'; }
            else if(bmi < 25) { status = 'Ù†Ø±Ù…Ø§Ù„'; color = 'text-green-600'; }
            else if(bmi < 30) { status = 'Ø§Ø¶Ø§ÙÙ‡ ÙˆØ²Ù†'; color = 'text-orange-600'; }
            else { status = 'Ú†Ø§Ù‚'; color = 'text-red-600'; }

            resDiv.innerHTML = `
                <div class="text-3xl font-bold mb-1">${bmi.toFixed(1)}</div>
                <div class="text-lg font-bold ${color}">${status}</div>
            `;
        }

        function calcPower() {
            const base = parseFloat(document.getElementById('pow-base').value);
            const exp = parseFloat(document.getElementById('pow-exp').value);
            if (isNaN(base) || isNaN(exp)) return;
            document.getElementById('pow-result').innerText = Math.pow(base, exp);
        }

        function calcRoot() {
            const x = parseFloat(document.getElementById('root-base').value);
            const n = parseFloat(document.getElementById('root-degree').value);
            if (isNaN(x) || isNaN(n) || n === 0) return;
            
            let res;
            if (x < 0 && n % 2 === 0) res = 'Error (Imaginary)';
            else if (x < 0) res = -Math.pow(-x, 1/n);
            else res = Math.pow(x, 1/n);
            
            document.getElementById('root-result').innerText = typeof res === 'number' ? res.toFixed(5) : res;
        }

        function calcAge() {
            const inputDate = document.getElementById('age-input').value;
            const resDiv = document.getElementById('age-result');
            
            if (!inputDate) {
                resDiv.innerHTML = '<span class="text-red-600">Ù„Ø·ÙØ§ ØªØ§Ø±ÛŒØ® ØªÙˆÙ„Ø¯ Ø±Ø§ Ø§Ù†ØªØ®Ø§Ø¨ Ú©Ù†ÛŒØ¯</span>';
                return;
            }

            const birthDate = new Date(inputDate);
            const now = new Date();
            
            if (birthDate > now) {
                resDiv.innerHTML = '<span class="text-red-600">ØªØ§Ø±ÛŒØ® ØªÙˆÙ„Ø¯ Ù†Ù…ÛŒâ€ŒØªÙˆØ§Ù†Ø¯ Ø¯Ø± Ø¢ÛŒÙ†Ø¯Ù‡ Ø¨Ø§Ø´Ø¯!</span>';
                return;
            }

            // Time difference in milliseconds
            let diff = now - birthDate;
            
            // Calculate seconds, minutes, hours, days
            const seconds = Math.floor(diff / 1000);
            const minutes = Math.floor(seconds / 60);
            const hours = Math.floor(minutes / 60);
            const totalDays = Math.floor(hours / 24);

            // Calculate precise years, months, days
            let years = now.getFullYear() - birthDate.getFullYear();
            let months = now.getMonth() - birthDate.getMonth();
            let days = now.getDate() - birthDate.getDate();

            if (days < 0) {
                months--;
                // Get days in previous month
                const prevMonth = new Date(now.getFullYear(), now.getMonth(), 0);
                days += prevMonth.getDate();
            }

            if (months < 0) {
                years--;
                months += 12;
            }

            resDiv.innerHTML = `
                <div class="font-bold text-lg text-green-700 dark:text-green-400 border-b border-gray-400/30 pb-2 w-full">
                    ${years} Ø³Ø§Ù„ Ùˆ ${months} Ù…Ø§Ù‡ Ùˆ ${days} Ø±ÙˆØ²
                </div>
                <div class="text-sm text-gray-600 dark:text-gray-300 grid grid-cols-2 gap-2 w-full pt-2">
                    <div class="glass-panel rounded-lg p-1 bg-white/20">
                        <span class="block text-xs opacity-70">Ù…Ø§Ù‡ (Ú©Ù„ÛŒ)</span>
                        <span class="font-mono font-bold">${(years * 12 + months).toLocaleString()}</span>
                    </div>
                    <div class="glass-panel rounded-lg p-1 bg-white/20">
                        <span class="block text-xs opacity-70">Ù‡ÙØªÙ‡</span>
                        <span class="font-mono font-bold">${Math.floor(totalDays / 7).toLocaleString()}</span>
                    </div>
                    <div class="glass-panel rounded-lg p-1 bg-white/20">
                        <span class="block text-xs opacity-70">Ø±ÙˆØ²</span>
                        <span class="font-mono font-bold">${totalDays.toLocaleString()}</span>
                    </div>
                     <div class="glass-panel rounded-lg p-1 bg-white/20">
                        <span class="block text-xs opacity-70">Ø«Ø§Ù†ÛŒÙ‡</span>
                        <span class="font-mono font-bold text-xs sm:text-sm">${seconds.toLocaleString()}</span>
                    </div>
                </div>
            `;
        }

        // --- Main Tabs Logic ---
        function switchTab(tab) {
            currentTab = tab;
            document.querySelectorAll('.nav-pill').forEach(btn => {
                btn.classList.remove('active');
                if(btn.id === `tab-${tab}`) btn.classList.add('active');
            });

            const content = document.getElementById('app-content');
            content.style.opacity = '0';
            setTimeout(() => {
                content.innerHTML = '';
                if(tab === 'basic') { displayVal = '0'; renderBasic(); }
                else if(tab === 'fraction') renderFraction();
                else if(tab === 'equation') renderEquation();
                else if(tab === 'number') renderNumber(); 
                else if(tab === 'polygon') renderPolygon(); 
                else if(tab === 'triangle') renderTriangle();
                content.style.opacity = '1';
            }, 200);
        }

        // --- Basic Calculator Render ---
        function renderBasic() {
            const container = document.getElementById('app-content');
            container.innerHTML = `
                <div class="flex flex-col h-full justify-end">
                    <div class="glass-panel rounded-[2rem] p-5 mb-5 text-right flex flex-col justify-center min-h-[5rem] shadow-inner border border-white/40 bg-white/10 dark:bg-black/20">
                        <span class="text-3xl sm:text-4xl font-mono font-semibold text-gray-800 dark:text-gray-100 break-all tracking-tight" id="calc-display">${displayVal}</span>
                    </div>

                    <div class="grid grid-cols-4 gap-2.5 sm:gap-3">
                        <button onclick="inputParen('(')" class="btn-bubble btn-func h-14 sm:h-16 w-full rounded-full font-semibold flex items-center justify-center shadow-lg">(</button>
                        <button onclick="inputParen(')')" class="btn-bubble btn-func h-14 sm:h-16 w-full rounded-full font-semibold flex items-center justify-center shadow-lg">)</button>
                        <button onclick="handlePercent()" class="btn-bubble btn-func h-14 sm:h-16 w-full rounded-full font-semibold flex items-center justify-center shadow-lg">%</button>
                        <button onclick="handleSqrt()" class="btn-bubble btn-func h-14 sm:h-16 w-full rounded-full font-semibold flex items-center justify-center shadow-lg">âˆš</button>

                        <button onclick="handleClear()" class="btn-bubble btn-ac h-14 sm:h-16 w-full rounded-full font-semibold text-lg flex items-center justify-center shadow-lg">AC</button>
                        <button onclick="handleOp('/')" class="btn-bubble btn-op h-14 sm:h-16 w-full rounded-full font-semibold text-xl flex items-center justify-center shadow-lg">Ã·</button>
                        <button onclick="handleOp('*')" class="btn-bubble btn-op h-14 sm:h-16 w-full rounded-full font-semibold text-xl flex items-center justify-center shadow-lg">Ã—</button>
                        <button onclick="handleOp('-')" class="btn-bubble btn-op h-14 sm:h-16 w-full rounded-full font-semibold text-xl flex items-center justify-center shadow-lg">-</button>

                        <button onclick="inputDigit(7)" class="btn-bubble h-14 sm:h-16 w-full rounded-full font-medium text-2xl text-gray-700 flex items-center justify-center">7</button>
                        <button onclick="inputDigit(8)" class="btn-bubble h-14 sm:h-16 w-full rounded-full font-medium text-2xl text-gray-700 flex items-center justify-center">8</button>
                        <button onclick="inputDigit(9)" class="btn-bubble h-14 sm:h-16 w-full rounded-full font-medium text-2xl text-gray-700 flex items-center justify-center">9</button>
                        <button onclick="handleOp('+')" class="btn-bubble btn-op h-14 sm:h-16 w-full rounded-full font-semibold text-xl flex items-center justify-center shadow-lg">+</button>

                        <button onclick="inputDigit(4)" class="btn-bubble h-14 sm:h-16 w-full rounded-full font-medium text-2xl text-gray-700 flex items-center justify-center">4</button>
                        <button onclick="inputDigit(5)" class="btn-bubble h-14 sm:h-16 w-full rounded-full font-medium text-2xl text-gray-700 flex items-center justify-center">5</button>
                        <button onclick="inputDigit(6)" class="btn-bubble h-14 sm:h-16 w-full rounded-full font-medium text-2xl text-gray-700 flex items-center justify-center">6</button>
                        <button onclick="handleEqual()" class="btn-bubble btn-eq rounded-[2rem] font-semibold text-3xl row-span-2 shadow-glow flex items-center justify-center">=</button>

                        <button onclick="inputDigit(1)" class="btn-bubble h-14 sm:h-16 w-full rounded-full font-medium text-2xl text-gray-700 flex items-center justify-center">1</button>
                        <button onclick="inputDigit(2)" class="btn-bubble h-14 sm:h-16 w-full rounded-full font-medium text-2xl text-gray-700 flex items-center justify-center">2</button>
                        <button onclick="inputDigit(3)" class="btn-bubble h-14 sm:h-16 w-full rounded-full font-medium text-2xl text-gray-700 flex items-center justify-center">3</button>

                        <button onclick="inputDigit(0)" class="btn-bubble w-full col-span-2 rounded-full font-medium text-2xl text-gray-700 flex items-center justify-center h-14 sm:h-16">0</button>
                        <button onclick="inputDot()" class="btn-bubble h-14 sm:h-16 w-full rounded-full font-semibold text-2xl text-gray-700 flex items-center justify-center">.</button>
                    </div>
                </div>
            `;
        }

        function updateDisplay() {
            const display = document.getElementById('calc-display');
            if(display) display.innerText = displayVal;
        }

        function inputDigit(digit) {
            if(displayVal === '0' || displayVal === 'Error') {
                displayVal = String(digit);
            } else {
                displayVal += digit;
            }
            updateDisplay();
        }

        function inputDot() {
            if (displayVal.slice(-1) !== '.') {
                displayVal += '.';
                updateDisplay();
            }
        }

        function inputParen(paren) {
            if(displayVal === '0' && paren === '(') {
                displayVal = '(';
            } else if (displayVal === 'Error') {
                displayVal = paren;
            } else {
                displayVal += paren;
            }
            updateDisplay();
        }

        function handleOp(op) {
            if(displayVal === 'Error') displayVal = '0';
            const lastChar = displayVal.slice(-1);
            if (['+', '-', '*', '/'].includes(lastChar)) {
                displayVal = displayVal.slice(0, -1) + op;
            } else {
                displayVal += op;
            }
            updateDisplay();
        }

        function handleClear() {
            displayVal = '0';
            updateDisplay();
        }

        function handleSqrt() {
            try {
                const val = eval(displayVal);
                if (val < 0) {
                    displayVal = 'Error';
                } else {
                    const res = Math.sqrt(val);
                    const resStr = String(parseFloat(res.toFixed(8)));
                    addToHistory(`âˆš(${displayVal})`, resStr);
                    displayVal = resStr;
                }
            } catch (e) {
                displayVal = 'Error';
            }
            updateDisplay();
        }

        function handlePercent() {
            try {
                const val = eval(displayVal);
                const res = val / 100;
                const resStr = String(parseFloat(res.toFixed(8)));
                addToHistory(`${displayVal}%`, resStr); 
                displayVal = resStr;
            } catch (e) {
                displayVal = 'Error';
            }
            updateDisplay();
        }

        function handleEqual() {
            // Easter Egg Check
            if (displayVal === '1391') {
                document.body.classList.toggle('easter-egg-active');
                showToast('ğŸ‰ Easter Egg Found! ğŸ‰');
                displayVal = '0';
                updateDisplay();
                return;
            }

            try {
                const prevExpr = displayVal;
                const result = new Function('return ' + displayVal)();
                if(!isFinite(result) || isNaN(result)) {
                     displayVal = 'Error';
                } else {
                     const resStr = String(parseFloat(result.toFixed(8)));
                     addToHistory(prevExpr, resStr);
                     displayVal = resStr;
                }
            } catch (e) {
                displayVal = 'Error';
            }
            updateDisplay();
        }

        // --- 2. Fraction (Unchanged Logic) ---
        function gcd(a, b) { return b == 0 ? a : gcd(b, a % b); }

        function renderFraction() {
            document.getElementById('app-content').innerHTML = `
                <div class="flex flex-col gap-6 items-center pt-4">
                    <h3 class="text-gray-700 dark:text-gray-300 font-semibold text-lg opacity-80">Ù…Ø­Ø§Ø³Ø¨Ù‡ Ú©Ø³Ø± Ù¾ÛŒØ´Ø±ÙØªÙ‡</h3>
                    
                    <div class="glass-panel w-full rounded-[2.5rem] p-6 flex flex-col items-center gap-4 relative">
                        <div class="flex items-center justify-center gap-3 w-full" dir="ltr">
                            <div class="flex flex-col items-center gap-2 w-20">
                                <input type="number" id="n1" class="glass-input w-full h-12 rounded-2xl text-center text-xl font-mono placeholder-gray-500" placeholder="a">
                                <div class="w-full h-px bg-gray-500/50 my-1"></div>
                                <input type="number" id="d1" class="glass-input w-full h-12 rounded-2xl text-center text-xl font-mono placeholder-gray-500" placeholder="b">
                            </div>

                            <div class="relative group">
                                <select id="frac-op" class="appearance-none bg-white/30 border border-white/50 text-gray-800 text-2xl font-bold rounded-full w-14 h-14 text-center cursor-pointer hover:bg-white/50 transition-all focus:outline-none focus:ring-2 focus:ring-gray-400">
                                    <option value="+">+</option>
                                    <option value="-">-</option>
                                    <option value="*">Ã—</option>
                                    <option value="/">Ã·</option>
                                </select>
                            </div>

                            <div class="flex flex-col items-center gap-2 w-20">
                                <input type="number" id="n2" class="glass-input w-full h-12 rounded-2xl text-center text-xl font-mono placeholder-gray-500" placeholder="c">
                                <div class="w-full h-px bg-gray-500/50 my-1"></div>
                                <input type="number" id="d2" class="glass-input w-full h-12 rounded-2xl text-center text-xl font-mono placeholder-gray-500" placeholder="d">
                            </div>
                        </div>

                        <button onclick="calcFraction()" class="btn-bubble btn-eq w-full h-14 rounded-full text-xl font-semibold mt-2 shadow-lg">
                            Ù…Ø­Ø§Ø³Ø¨Ù‡ Ù†ØªÛŒØ¬Ù‡
                        </button>
                    </div>

                    <div id="frac-result" class="glass-panel w-full min-h-[8rem] rounded-[2.5rem] flex items-center justify-center p-4">
                        <span class="text-gray-500 dark:text-gray-300 text-sm">Ø§Ø¹Ø¯Ø§Ø¯ Ø±Ø§ ÙˆØ§Ø±Ø¯ Ú©Ù†ÛŒØ¯...</span>
                    </div>
                </div>
            `;
        }

        function calcFraction() {
            const n1 = parseFloat(document.getElementById('n1').value);
            const d1 = parseFloat(document.getElementById('d1').value);
            const n2 = parseFloat(document.getElementById('n2').value);
            const d2 = parseFloat(document.getElementById('d2').value);
            const op = document.getElementById('frac-op').value;
            const resBox = document.getElementById('frac-result');

            if (isNaN(n1) || isNaN(d1) || isNaN(n2) || isNaN(d2)) {
                resBox.innerHTML = '<span class="text-red-700 font-bold">Ù„Ø·ÙØ§Ù‹ ØªÙ…Ø§Ù… Ø®Ø§Ù†Ù‡â€ŒÙ‡Ø§ Ø±Ø§ Ù¾Ø± Ú©Ù†ÛŒØ¯</span>';
                return;
            }
            if (d1 === 0 || d2 === 0) {
                resBox.innerHTML = '<span class="text-red-700 font-bold">Ù…Ø®Ø±Ø¬ Ù†Ù…ÛŒâ€ŒØªÙˆØ§Ù†Ø¯ ØµÙØ± Ø¨Ø§Ø´Ø¯!</span>';
                return;
            }

            let resN, resD;

            if (op === '+') {
                resN = (n1 * d2) + (n2 * d1);
                resD = d1 * d2;
            } else if (op === '-') {
                resN = (n1 * d2) - (n2 * d1);
                resD = d1 * d2;
            } else if (op === '*') {
                resN = n1 * n2;
                resD = d1 * d2;
            } else if (op === '/') {
                if(n2 === 0) {
                    resBox.innerHTML = '<span class="text-red-700 font-bold">ØªÙ‚Ø³ÛŒÙ… Ø¨Ø± ØµÙØ±!</span>';
                    return;
                }
                resN = n1 * d2;
                resD = d1 * n2;
            }

            const common = gcd(Math.abs(resN), Math.abs(resD));
            const finalN = resN / common;
            const finalD = resD / common;

            let html = '';
            
            if (finalD === 1) {
                 html = `<span class="text-5xl font-mono font-bold text-gray-800 dark:text-white drop-shadow-sm">${finalN}</span>`;
            } else if (finalD === -1) {
                 html = `<span class="text-5xl font-mono font-bold text-gray-800 dark:text-white drop-shadow-sm">${-finalN}</span>`;
            } else {
                let showN = finalN, showD = finalD;
                if (showD < 0) { showN = -showN; showD = -showD; }
                
                html = `
                    <div class="flex flex-col items-center animate-blob">
                        <span class="text-3xl font-mono font-bold text-gray-800 dark:text-white px-4">${showN}</span>
                        <div class="w-full h-0.5 bg-gray-600 rounded-full my-1"></div>
                        <span class="text-3xl font-mono font-bold text-gray-800 dark:text-white px-4">${showD}</span>
                    </div>
                `;
            }

            resBox.innerHTML = html;
        }

        // --- 3. Equation (Updated) ---
        function renderEquation() {
            document.getElementById('app-content').innerHTML = `
                 <div class="flex flex-col gap-4 pt-2">
                    <div class="glass-panel p-1.5 rounded-full flex gap-1 overflow-x-auto">
                         <button onclick="setEqMode('lin')" id="btn-lin" class="flex-1 whitespace-nowrap px-3 py-2 rounded-full text-xs font-semibold bg-white/50 text-gray-900 shadow-sm transition-all">Ø®Ø·ÛŒ</button>
                         <button onclick="setEqMode('frac')" id="btn-frac" class="flex-1 whitespace-nowrap px-3 py-2 rounded-full text-xs font-semibold text-gray-600 dark:text-gray-300 hover:bg-white/30 transition-all">Ú©Ø³Ø±ÛŒ</button>
                         <button onclick="setEqMode('system')" id="btn-system" class="flex-1 whitespace-nowrap px-3 py-2 rounded-full text-xs font-semibold text-gray-600 dark:text-gray-300 hover:bg-white/30 transition-all">Û² Ù…Ø¬Ù‡ÙˆÙ„ÛŒ</button>
                         <button onclick="setEqMode('table')" id="btn-table" class="flex-1 whitespace-nowrap px-3 py-2 rounded-full text-xs font-semibold text-gray-600 dark:text-gray-300 hover:bg-white/30 transition-all">Ø¬Ø¯ÙˆÙ„</button>
                    </div>

                    <div id="eq-inputs" class="glass-panel rounded-[2.5rem] p-6 flex flex-col gap-4 items-center">
                    </div>

                    <div id="eq-action-area" class="w-full">
                        <button onclick="solveEq()" class="btn-bubble btn-eq w-full h-14 rounded-full text-xl font-semibold shadow-lg">Ø­Ù„ Ù…Ø¹Ø§Ø¯Ù„Ù‡</button>
                    </div>
                    
                    <div id="eq-result" class="glass-panel min-h-[4rem] rounded-[2rem] flex flex-col items-center justify-center p-4 text-center font-bold text-gray-700 dark:text-gray-200">
                        Ù…Ù†ØªØ¸Ø± ÙˆØ±ÙˆØ¯ÛŒ...
                    </div>
                 </div>
            `;
            setEqMode('lin');
        }

        let eqMode = 'lin';
        function setEqMode(mode) {
            eqMode = mode;
            // Removed 'quad' from buttons array
            const buttons = ['lin', 'frac', 'system', 'table'];
            buttons.forEach(btn => {
                const el = document.getElementById(`btn-${btn}`);
                if (btn === mode) {
                    el.className = "flex-1 whitespace-nowrap px-3 py-2 rounded-full text-xs font-semibold bg-white/50 dark:bg-white/20 text-gray-900 dark:text-white shadow-sm transition-all";
                } else {
                    el.className = "flex-1 whitespace-nowrap px-3 py-2 rounded-full text-xs font-semibold text-gray-600 dark:text-gray-400 hover:bg-white/30 transition-all";
                }
            });

            const container = document.getElementById('eq-inputs');
            const actionArea = document.getElementById('eq-action-area');
            const resultArea = document.getElementById('eq-result');

            resultArea.innerText = 'Ù…Ù†ØªØ¸Ø± ÙˆØ±ÙˆØ¯ÛŒ...';
            actionArea.innerHTML = `<button onclick="solveEq()" class="btn-bubble btn-eq w-full h-14 rounded-full text-xl font-semibold shadow-lg">Ø­Ù„ Ù…Ø¹Ø§Ø¯Ù„Ù‡</button>`;

            if (mode === 'lin') {
                container.innerHTML = `
                    <div class="flex items-center gap-2 text-lg font-semibold text-gray-600 dark:text-gray-300" dir="ltr">
                        <input id="lin-a" type="number" class="glass-input w-14 h-12 rounded-xl text-center" placeholder="a">
                        <span>x +</span>
                        <input id="lin-b" type="number" class="glass-input w-14 h-12 rounded-xl text-center" placeholder="b">
                        <span>=</span>
                        <input id="lin-c" type="number" class="glass-input w-14 h-12 rounded-xl text-center" placeholder="c">
                    </div>
                    <p class="text-xs text-gray-500 font-sans">ÙØ±Ù…Øª: ax + b = c</p>
                `;
            } else if (mode === 'system') {
                container.innerHTML = `
                    <div class="flex flex-col gap-3 w-full">
                        <div class="flex items-center justify-center gap-1 text-base font-semibold text-gray-600 dark:text-gray-300" dir="ltr">
                            <input id="s-a1" type="number" class="glass-input w-12 h-10 rounded-xl text-center" placeholder="a1">
                            <span>x +</span>
                            <input id="s-b1" type="number" class="glass-input w-12 h-10 rounded-xl text-center" placeholder="b1">
                            <span>y =</span>
                            <input id="s-c1" type="number" class="glass-input w-12 h-10 rounded-xl text-center" placeholder="c1">
                        </div>
                        <div class="flex items-center justify-center gap-1 text-base font-semibold text-gray-600 dark:text-gray-300" dir="ltr">
                            <input id="s-a2" type="number" class="glass-input w-12 h-10 rounded-xl text-center" placeholder="a2">
                            <span>x +</span>
                            <input id="s-b2" type="number" class="glass-input w-12 h-10 rounded-xl text-center" placeholder="b2">
                            <span>y =</span>
                            <input id="s-c2" type="number" class="glass-input w-12 h-10 rounded-xl text-center" placeholder="c2">
                        </div>
                        <p class="text-xs text-gray-500 font-sans">ÙØ±Ù…Øª: aâ‚x + bâ‚y = câ‚, aâ‚‚x + bâ‚‚y = câ‚‚</p>
                    </div>
                `;
            } else if (mode === 'frac') {
                container.innerHTML = `
                    <div class="flex items-center gap-2 text-lg font-semibold text-gray-600 dark:text-gray-300" dir="ltr">
                        <div class="flex flex-col items-center">
                            <div class="flex items-center gap-1">
                                <input id="f-a" type="number" class="glass-input w-10 h-10 rounded-xl text-center" placeholder="a">
                                <span>x +</span>
                                <input id="f-b" type="number" class="glass-input w-10 h-10 rounded-xl text-center" placeholder="b">
                            </div>
                            <div class="w-full h-px bg-gray-500/50 my-1"></div>
                            <div class="flex items-center gap-1">
                                <input id="f-c" type="number" class="glass-input w-10 h-10 rounded-xl text-center" placeholder="c">
                                <span>x +</span>
                                <input id="f-d" type="number" class="glass-input w-10 h-10 rounded-xl text-center" placeholder="d">
                            </div>
                        </div>
                        <span>=</span>
                        <input id="f-e" type="number" class="glass-input w-14 h-12 rounded-xl text-center" placeholder="e">
                    </div>
                    <p class="text-xs text-gray-500 font-sans">ÙØ±Ù…Øª: (ax + b) / (cx + d) = e</p>
                `;
            } else if (mode === 'table') {
                container.innerHTML = `
                    <div class="w-full flex flex-col gap-4">
                        <div class="flex flex-col items-center w-full">
                            <label class="text-sm text-gray-600 dark:text-gray-300 font-bold mb-2">Ø¹Ø¨Ø§Ø±Øª ØªØ§Ø¨Ø¹ (y Ø¨Ø± Ø­Ø³Ø¨ x)</label>
                            <div class="flex items-center gap-2 w-full justify-center" dir="ltr">
                                <span class="font-mono text-xl text-gray-700 dark:text-gray-300 font-bold">y =</span>
                                <input id="tbl-eq" type="text" class="glass-input w-2/3 h-12 rounded-xl text-center font-mono text-lg" placeholder="Ù…Ø«Ù„Ø§: 2x + 1">
                            </div>
                        </div>

                        <div class="glass-panel w-full rounded-2xl p-2 dark:bg-white/5">
                            <div class="grid grid-cols-2 gap-2 mb-2 text-center border-b border-gray-400/30 pb-2">
                                <div class="font-mono font-bold text-gray-700 dark:text-gray-200 text-lg">x</div>
                                <div class="font-mono font-bold text-gray-700 dark:text-gray-200 text-lg">y</div>
                            </div>
                            <div class="flex flex-col gap-2" id="table-rows">
                                ${[0, 1, 2, 3].map(i => `
                                    <div class="grid grid-cols-2 gap-2">
                                        <input type="number" id="tbl-x-${i}" class="glass-input w-full h-10 rounded-lg text-center font-mono" placeholder="x">
                                        <input type="number" id="tbl-y-${i}" class="glass-input w-full h-10 rounded-lg text-center font-mono" placeholder="y">
                                    </div>
                                `).join('')}
                            </div>
                        </div>
                    </div>
                `;
                actionArea.innerHTML = `<button onclick="solveTableEquation()" class="btn-bubble btn-eq w-full h-14 rounded-full text-xl font-semibold shadow-lg">ØªÚ©Ù…ÛŒÙ„ Ø¬Ø¯ÙˆÙ„</button>`;
                resultArea.innerText = 'Ù…Ù‚Ø§Ø¯ÛŒØ± Ø®Ø§Ù„ÛŒ Ø±Ø§ Ù¾Ø± Ú©Ù†ÛŒØ¯';
            }
        }

        // --- Logic for Table Mode ---
        function solveTableEquation() {
            const eqInput = document.getElementById('tbl-eq').value.trim();
            if (!eqInput) {
                document.getElementById('eq-result').innerHTML = '<span class="text-red-600">Ù„Ø·ÙØ§Ù‹ Ù…Ø¹Ø§Ø¯Ù„Ù‡ Ø±Ø§ ÙˆØ§Ø±Ø¯ Ú©Ù†ÛŒØ¯</span>';
                return;
            }

            let parsedEq = eqInput.replace(/(\d)([a-zA-Z(])/g, '$1*$2');
            parsedEq = parsedEq.replace(/(\))([a-zA-Z0-9])/g, '$1*$2');

            const evaluateFunc = (xVal) => {
                try {
                    const func = new Function('x', `return ${parsedEq};`);
                    return func(xVal);
                } catch (e) {
                    return NaN;
                }
            };

            const solveForX = (yTarget) => {
                let x0 = -10, x1 = 10;
                let iter = 0;
                while (iter < 50) {
                    let y0 = evaluateFunc(x0) - yTarget;
                    let y1 = evaluateFunc(x1) - yTarget;
                    if (Math.abs(y1) < 0.0001) return x1;
                    if (Math.abs(y1 - y0) < 0.0000001) break; 
                    
                    let xNew = x1 - y1 * (x1 - x0) / (y1 - y0);
                    x0 = x1;
                    x1 = xNew;
                    iter++;
                }
                return x1;
            };

            let filledCount = 0;
            let errorOccurred = false;

            for (let i = 0; i < 4; i++) {
                const xEl = document.getElementById(`tbl-x-${i}`);
                const yEl = document.getElementById(`tbl-y-${i}`);
                
                const xValStr = xEl.value;
                const yValStr = yEl.value;

                if (xValStr !== '' && yValStr === '') {
                    const xVal = parseFloat(xValStr);
                    const yVal = evaluateFunc(xVal);
                    if (!isNaN(yVal)) {
                        yEl.value = parseFloat(yVal.toFixed(4));
                        yEl.classList.add('bg-green-100/50');
                        filledCount++;
                    } else {
                        errorOccurred = true;
                    }
                } else if (yValStr !== '' && xValStr === '') {
                    const yVal = parseFloat(yValStr);
                    const xVal = solveForX(yVal);
                    if (!isNaN(xVal) && Math.abs(evaluateFunc(xVal) - yVal) < 0.1) {
                         xEl.value = parseFloat(xVal.toFixed(4));
                         xEl.classList.add('bg-green-100/50'); 
                         filledCount++;
                    }
                }
            }

            if (errorOccurred) {
                document.getElementById('eq-result').innerHTML = '<span class="text-red-600">Ø®Ø·Ø§ Ø¯Ø± Ù…Ø­Ø§Ø³Ø¨Ù‡ Ù…Ø¹Ø§Ø¯Ù„Ù‡</span>';
            } else if (filledCount > 0) {
                document.getElementById('eq-result').innerHTML = '<span class="text-green-700">Ø¬Ø¯ÙˆÙ„ ØªÚ©Ù…ÛŒÙ„ Ø´Ø¯</span>';
            } else {
                document.getElementById('eq-result').innerText = 'ØªØºÛŒÛŒØ±ÛŒ Ø§ÛŒØ¬Ø§Ø¯ Ù†Ø´Ø¯';
            }
        }


        function solveEq() {
            const resDiv = document.getElementById('eq-result');
            if (eqMode === 'lin') {
                const a = parseFloat(document.getElementById('lin-a').value);
                const b = parseFloat(document.getElementById('lin-b').value);
                const c = parseFloat(document.getElementById('lin-c').value);
                if(isNaN(a) || isNaN(b) || isNaN(c)) { resDiv.innerHTML = '<span class="text-red-600">ÙˆØ±ÙˆØ¯ÛŒ Ù†Ø§Ù‚Øµ</span>'; return;}
                if(a === 0) { resDiv.innerHTML = '<span class="text-red-700">a Ù†Ø¨Ø§ÛŒØ¯ ØµÙØ± Ø¨Ø§Ø´Ø¯</span>'; return; }
                const x = (c - b) / a;
                
                // --- Step by Step Logic ---
                const stepHTML = `
                    <div id="steps-container" class="hidden text-right text-sm text-gray-600 dark:text-gray-300 mt-2 bg-white/20 p-2 rounded-xl w-full">
                        <div class="mb-1 font-bold">Ù…Ø±Ø§Ø­Ù„ Ø­Ù„:</div>
                        <div>1. Ø§Ø¨ØªØ¯Ø§ Ø¹Ø¯Ø¯ Ø«Ø§Ø¨Øª (${b}) Ø±Ø§ Ø¨Ù‡ Ø³Ù…Øª Ø±Ø§Ø³Øª Ù…Ù†ØªÙ‚Ù„ Ù…ÛŒâ€ŒÚ©Ù†ÛŒÙ…:</div>
                        <div class="font-mono text-center my-1" dir="ltr">${a}x = ${c} - ${b}</div>
                        <div class="font-mono text-center my-1" dir="ltr">${a}x = ${c - b}</div>
                        <div>2. Ø³Ù¾Ø³ Ø·Ø±ÙÛŒÙ† Ø±Ø§ Ø¨Ø± Ø¶Ø±ÛŒØ¨ x (${a}) ØªÙ‚Ø³ÛŒÙ… Ù…ÛŒâ€ŒÚ©Ù†ÛŒÙ…:</div>
                        <div class="font-mono text-center my-1" dir="ltr">x = ${c - b} / ${a}</div>
                        <div class="font-mono text-center my-1 font-bold" dir="ltr">x = ${parseFloat(x.toFixed(4))}</div>
                    </div>
                `;

                resDiv.innerHTML = `
                    <div class="flex flex-col items-center gap-2 w-full">
                        <span class="text-2xl font-mono text-gray-900 dark:text-white">x = ${parseFloat(x.toFixed(4))}</span>
                        <button onclick="toggleLinearSteps()" class="text-xs bg-blue-100 dark:bg-blue-900 text-blue-700 dark:text-blue-300 px-3 py-1 rounded-full hover:bg-blue-200 transition-colors">Ù†Ù…Ø§ÛŒØ´ Ø±Ø§Ù‡ Ø­Ù„</button>
                        ${stepHTML}
                    </div>
                `;
            } else if (eqMode === 'system') {
                const a1 = parseFloat(document.getElementById('s-a1').value);
                const b1 = parseFloat(document.getElementById('s-b1').value);
                const c1 = parseFloat(document.getElementById('s-c1').value);
                const a2 = parseFloat(document.getElementById('s-a2').value);
                const b2 = parseFloat(document.getElementById('s-b2').value);
                const c2 = parseFloat(document.getElementById('s-c2').value);

                if(isNaN(a1) || isNaN(b1) || isNaN(c1) || isNaN(a2) || isNaN(b2) || isNaN(c2)) { 
                    resDiv.innerHTML = '<span class="text-red-600">ÙˆØ±ÙˆØ¯ÛŒ Ù†Ø§Ù‚Øµ</span>'; 
                    return;
                }

                const D = a1 * b2 - a2 * b1;

                if (D === 0) {
                    const Dx = c1 * b2 - c2 * b1;
                    const Dy = a1 * c2 - a2 * c1;
                    if (Dx === 0 && Dy === 0) {
                        resDiv.innerHTML = '<span class="text-orange-700">ØªØ¹Ø¯Ø§Ø¯ Ù†Ø§Ù…Ø­Ø¯ÙˆØ¯ Ø¬ÙˆØ§Ø¨ Ø¯Ø§Ø±Ø¯</span>';
                    } else {
                        resDiv.innerHTML = '<span class="text-red-700">ÙØ§Ù‚Ø¯ Ø¬ÙˆØ§Ø¨ Ø§Ø³Øª (Ø®Ø·ÙˆØ· Ù…ÙˆØ§Ø²ÛŒ)</span>';
                    }
                } else {
                    const Dx = c1 * b2 - c2 * b1;
                    const Dy = a1 * c2 - a2 * c1;
                    const x = Dx / D;
                    const y = Dy / D;
                    resDiv.innerHTML = `
                        <div class="flex flex-col font-mono text-gray-900 dark:text-white">
                            <span class="mb-1">x = ${x.toFixed(4)}</span>
                            <span>y = ${y.toFixed(4)}</span>
                        </div>
                    `;
                }
            } else if (eqMode === 'frac') {
                const a = parseFloat(document.getElementById('f-a').value);
                const b = parseFloat(document.getElementById('f-b').value);
                const c = parseFloat(document.getElementById('f-c').value);
                const d = parseFloat(document.getElementById('f-d').value);
                const e = parseFloat(document.getElementById('f-e').value);

                if(isNaN(a) || isNaN(b) || isNaN(c) || isNaN(d) || isNaN(e)) { 
                    resDiv.innerHTML = '<span class="text-red-600">ÙˆØ±ÙˆØ¯ÛŒ Ù†Ø§Ù‚Øµ</span>'; 
                    return;
                }
                
                const denominator = a - e * c;
                const numerator = e * d - b;

                if (denominator === 0) {
                    if (numerator === 0) {
                        resDiv.innerHTML = '<span class="text-orange-700">ØªØ¹Ø¯Ø§Ø¯ Ù†Ø§Ù…Ø­Ø¯ÙˆØ¯ Ø¬ÙˆØ§Ø¨ Ø¯Ø§Ø±Ø¯</span>';
                    } else {
                        resDiv.innerHTML = '<span class="text-red-700">ÙØ§Ù‚Ø¯ Ø¬ÙˆØ§Ø¨ Ø§Ø³Øª</span>';
                    }
                } else {
                    const x = numerator / denominator;
                    if (c * x + d === 0) {
                        resDiv.innerHTML = '<span class="text-red-700">Ø¬ÙˆØ§Ø¨ Ù‚Ø§Ø¨Ù„ Ù‚Ø¨ÙˆÙ„ Ù†ÛŒØ³Øª (Ù…Ø®Ø±Ø¬ Ú©Ø³Ø± Ø§ÙˆÙ„ÛŒÙ‡ ØµÙØ± Ù…ÛŒâ€ŒØ´ÙˆØ¯)</span>';
                    } else {
                        resDiv.innerHTML = `<span class="text-2xl font-mono text-gray-900 dark:text-white">x = ${x.toFixed(4)}</span>`;
                    }
                }
            }
        }

        function toggleLinearSteps() {
            const el = document.getElementById('steps-container');
            if (el.classList.contains('hidden')) {
                el.classList.remove('hidden');
            } else {
                el.classList.add('hidden');
            }
        }

        // --- 4. Number Properties (Unchanged Logic) ---
        function getPrimeFactorization(n) {
            let num = n;
            let factors = {};
            let i = 2;
            while (i * i <= num) {
                while (num % i === 0) {
                    factors[i] = (factors[i] || 0) + 1;
                    num /= i;
                }
                i++;
            }
            if (num > 1) {
                factors[num] = (factors[num] || 0) + 1;
            }
            return factors;
        }

        function renderNumber() {
            document.getElementById('app-content').innerHTML = `
                <div class="flex flex-col gap-6 pt-6 items-center">
                    <h3 class="text-gray-700 dark:text-gray-300 font-semibold text-lg opacity-80">Ø¨Ø±Ø±Ø³ÛŒ Ø§ÙˆÙ„/Ù…Ø±Ú©Ø¨ Ø¨ÙˆØ¯Ù† Ùˆ Ø®ÙˆØ§Øµ</h3>
                    <div class="glass-panel w-full p-8 rounded-[3rem] flex flex-col items-center">
                        <label class="text-gray-600 dark:text-gray-300 font-semibold mb-3">Ø¹Ø¯Ø¯ ØµØ­ÛŒØ­ Ùˆ Ù…Ø«Ø¨Øª Ø±Ø§ ÙˆØ§Ø±Ø¯ Ú©Ù†ÛŒØ¯ (Ø­Ø¯Ø§Ú©Ø«Ø± 1000)</label>
                        <input id="num-input" type="number" min="1" step="1" max="1000" class="glass-input w-full h-16 text-3xl text-center rounded-2xl font-mono text-gray-800 placeholder-gray-400" placeholder="17">
                    </div>

                    <button onclick="checkPrime()" class="btn-bubble btn-eq h-14 rounded-full text-xl font-semibold shadow-lg">Ø¨Ø±Ø±Ø³ÛŒ Ø®ÙˆØ§Øµ</button>

                    <div id="num-result" class="glass-panel w-full min-h-[12rem] rounded-[2.5rem] flex flex-col items-center p-4 gap-2">
                        <span class="text-center text-gray-500 dark:text-gray-300 text-sm">Ù†ØªÛŒØ¬Ù‡ Ø§ÛŒÙ†Ø¬Ø§ Ù†Ù…Ø§ÛŒØ´ Ø¯Ø§Ø¯Ù‡ Ù…ÛŒâ€ŒØ´ÙˆØ¯</span>
                    </div>
                </div>
            `;
        }

        function checkPrime() {
            const val = document.getElementById('num-input').value;
            const num = parseInt(val);
            const box = document.getElementById('num-result');
            
            if (isNaN(num) || num <= 0 || !Number.isInteger(num)) {
                box.innerHTML = '<span class="text-center text-red-600 font-bold">Ù„Ø·ÙØ§Ù‹ ÛŒÚ© Ø¹Ø¯Ø¯ ØµØ­ÛŒØ­ Ù…Ø«Ø¨Øª ÙˆØ§Ø±Ø¯ Ú©Ù†ÛŒØ¯.</span>';
                return;
            }
            if (num > 1000) {
                box.innerHTML = '<span class="text-center text-red-600 font-bold">Ø¨Ø±Ø§ÛŒ Ø¹Ù…Ù„Ú©Ø±Ø¯ Ø¨Ù‡ØªØ±ØŒ Ø¹Ø¯Ø¯ Ø­Ø¯Ø§Ú©Ø«Ø± 1000 Ø¨Ø§Ø´Ø¯.</span>';
                return;
            }

            let resultHtml = '';
            let divisors = [];
            let primeDivisors = [];

            for (let i = 1; i <= num; i++) {
                if (num % i === 0) {
                    divisors.push(i);
                    if (i > 1) {
                        let isPrimeDivisor = true;
                        for(let j = 2; j <= Math.sqrt(i); j++) {
                            if (i % j === 0) {
                                isPrimeDivisor = false;
                                break;
                            }
                        }
                        if(isPrimeDivisor) primeDivisors.push(i);
                    }
                }
            }

            let primeStatus = '';
            if (num === 1) {
                primeStatus = '<span class="text-2xl text-orange-700 font-bold">Ø¹Ø¯Ø¯ Û±: Ù†Ù‡ Ø§ÙˆÙ„ Ø§Ø³Øª Ùˆ Ù†Ù‡ Ù…Ø±Ú©Ø¨.</span>';
            } else if (divisors.length === 2) {
                primeStatus = `<span class="text-2xl text-green-700 font-bold">Ø¹Ø¯Ø¯ ${num}: Ø§ÙˆÙ„ Ø§Ø³Øª.</span>`;
            } else {
                primeStatus = `<span class="text-2xl text-blue-700 font-bold">Ø¹Ø¯Ø¯ ${num}: Ù…Ø±Ú©Ø¨ Ø§Ø³Øª.</span>`;
            }

            const factors = getPrimeFactorization(num);
            let factorizationStr = '';
            for (const [base, exp] of Object.entries(factors)) {
                if (exp === 1) {
                    factorizationStr += `${base} Ã— `;
                } else {
                    factorizationStr += `${base}<sup>${exp}</sup> Ã— `;
                }
            }
            factorizationStr = factorizationStr.slice(0, -3) || `${num} (ÙØ§Ú©ØªÙˆØ±Ú¯ÛŒØ±ÛŒ Ù„Ø§Ø²Ù… Ù†ÛŒØ³Øª)`;

            resultHtml = `
                ${primeStatus}
                <div class="mt-4 w-full text-base font-sans" dir="rtl">
                    <p class="font-semibold text-gray-700 dark:text-gray-300 mb-2">Ù…Ù‚Ø³ÙˆÙ…â€ŒØ¹Ù„ÛŒÙ‡â€ŒÙ‡Ø§ (Ø§Ø¹Ø¯Ø§Ø¯ÛŒ Ú©Ù‡ Ø¨Ø± Ø¢Ù†â€ŒÙ‡Ø§ Ø¨Ø®Ø´â€ŒÙ¾Ø°ÛŒØ± Ø§Ø³Øª):</p>
                    <div class="p-2 bg-white/50 dark:bg-white/10 rounded-xl text-sm break-words">
                        <span class="font-mono text-gray-900 dark:text-white">${divisors.join(', ')}</span>
                    </div>

                    <p class="font-semibold text-gray-700 dark:text-gray-300 mt-4 mb-2">ØªØ¬Ø²ÙŠÙ‡ Ø¨Ù‡ Ø¹ÙˆØ§Ù…Ù„ Ø§ÙˆÙ„:</p>
                    <div class="p-2 bg-white/50 dark:bg-white/10 rounded-xl text-sm break-words">
                        <span class="font-mono text-gray-900 dark:text-white">${factorizationStr}</span>
                    </div>
                </div>
            `;

            box.innerHTML = resultHtml;
        }

        // --- 5. Polygon (Unchanged Logic) ---
        function renderPolygon() {
            document.getElementById('app-content').innerHTML = `
                <div class="flex flex-col gap-6 pt-6 items-center">
                    <h3 class="text-gray-700 dark:text-gray-300 font-semibold text-lg opacity-80">Ø®ÙˆØ§Øµ Ú†Ù†Ø¯Ø¶Ù„Ø¹ÛŒ Ù…Ù†ØªØ¸Ù…</h3>
                    <div class="glass-panel w-full p-8 rounded-[3rem] flex flex-col items-center">
                        <label class="text-gray-600 dark:text-gray-300 font-semibold mb-3">ØªØ¹Ø¯Ø§Ø¯ Ø§Ø¶Ù„Ø§Ø¹ (n â‰¥ 3)</label>
                        <input id="poly-input" type="number" min="3" step="1" class="glass-input w-full h-16 text-3xl text-center rounded-2xl font-mono text-gray-800 placeholder-gray-400" placeholder="6">
                    </div>

                    <button onclick="calcPolygonProperties()" class="btn-bubble btn-eq h-14 rounded-full text-xl font-semibold shadow-lg">Ù…Ø­Ø§Ø³Ø¨Ù‡ Ø®ÙˆØ§Øµ</button>

                    <div id="poly-result" class="glass-panel w-full min-h-[15rem] rounded-[2.5rem] flex flex-col justify-center px-4 py-6 gap-3">
                         <span class="text-center text-gray-500 dark:text-gray-300 text-sm">Ù†ØªØ§ÛŒØ¬ Ø§ÛŒÙ†Ø¬Ø§ Ù†Ù…Ø§ÛŒØ´ Ø¯Ø§Ø¯Ù‡ Ù…ÛŒâ€ŒØ´ÙˆØ¯</span>
                    </div>
                </div>
            `;
        }

        function calcPolygonProperties() {
            const val = document.getElementById('poly-input').value;
            const n = parseInt(val);
            const box = document.getElementById('poly-result');
            
            if (isNaN(n) || n < 3 || !Number.isInteger(n)) {
                box.innerHTML = '<span class="text-center text-red-600 font-bold">Ù„Ø·ÙØ§Ù‹ ØªØ¹Ø¯Ø§Ø¯ Ø§Ø¶Ù„Ø§Ø¹ Ø±Ø§ ÛŒÚ© Ø¹Ø¯Ø¯ ØµØ­ÛŒØ­ Ø¨Ø²Ø±Ú¯ØªØ± ÛŒØ§ Ù…Ø³Ø§ÙˆÛŒ Û³ ÙˆØ§Ø±Ø¯ Ú©Ù†ÛŒØ¯.</span>';
                return;
            }

            const hasCenter = n % 2 === 0 ? 'Ø¨Ù„Ù‡ØŒ Ø¯Ø§Ø±Ø¯ (ÙÙ‚Ø· Ø¨Ø±Ø§ÛŒ n Ø²ÙˆØ¬)' : 'Ø®ÛŒØ±ØŒ Ù†Ø¯Ø§Ø±Ø¯';
            const axesCount = n;
            const sumInt = (n - 2) * 180;
            const eachInt = sumInt / n;
            const sumExt = 360;
            const eachExt = 360 / n;

            box.innerHTML = `
                <div class="text-center mb-4">
                    <span class="text-2xl font-bold text-gray-800 dark:text-white">${n}-Ø¶Ù„Ø¹ÛŒ Ù…Ù†ØªØ¸Ù…</span>
                </div>
                <div class="result-grid">
                    <div class="result-item">
                        <span class="text-xs text-gray-600 dark:text-gray-300">Ù…Ø±Ú©Ø² ØªÙ‚Ø§Ø±Ù†:</span>
                        <span class="text-lg font-bold ${n % 2 === 0 ? 'text-green-700 dark:text-green-400' : 'text-red-700 dark:text-red-400'}">${hasCenter}</span>
                    </div>
                    <div class="result-item">
                        <span class="text-xs text-gray-600 dark:text-gray-300">ØªØ¹Ø¯Ø§Ø¯ Ù…Ø­ÙˆØ± ØªÙ‚Ø§Ø±Ù†:</span>
                        <span class="text-2xl font-mono font-bold text-gray-900 dark:text-white">${axesCount}</span>
                    </div>
                    <div class="result-item">
                        <span class="text-xs text-gray-600 dark:text-gray-300">Ù…Ø¬Ù…ÙˆØ¹ Ø²ÙˆØ§ÛŒØ§ÛŒ Ø¯Ø§Ø®Ù„ÛŒ:</span>
                        <span class="text-xl font-mono font-bold text-gray-900 dark:text-white">${sumInt}Â°</span>
                    </div>
                    <div class="result-item">
                        <span class="text-xs text-gray-600 dark:text-gray-300">Ù‡Ø± Ø²Ø§ÙˆÛŒÙ‡ Ø¯Ø§Ø®Ù„ÛŒ:</span>
                        <span class="text-xl font-mono font-bold text-gray-900 dark:text-white">${eachInt.toFixed(2)}Â°</span>
                    </div>
                    <div class="result-item">
                        <span class="text-xs text-gray-600 dark:text-gray-300">Ù…Ø¬Ù…ÙˆØ¹ Ø²ÙˆØ§ÛŒØ§ÛŒ Ø®Ø§Ø±Ø¬ÛŒ:</span>
                        <span class="text-xl font-mono font-bold text-gray-900 dark:text-white">${sumExt}Â°</span>
                    </div>
                    <div class="result-item">
                        <span class="text-xs text-gray-600 dark:text-gray-300">Ù‡Ø± Ø²Ø§ÙˆÛŒÙ‡ Ø®Ø§Ø±Ø¬ÛŒ:</span>
                        <span class="text-xl font-mono font-bold text-gray-900 dark:text-white">${eachExt.toFixed(2)}Â°</span>
                    </div>
                </div>
            `;
        }
        
        // --- 6. Triangle (Unchanged Logic) ---
        function renderTriangle() {
            document.getElementById('app-content').innerHTML = `
                <div class="flex flex-col gap-6 pt-6 items-center">
                    <h3 class="text-gray-700 dark:text-gray-300 font-semibold text-lg opacity-80">Ù‚Ø¶ÛŒÙ‡ Ø²Ø§ÙˆÛŒÙ‡ Ø®Ø§Ø±Ø¬ÛŒ Ù…Ø«Ù„Ø« ğŸ“</h3>
                    
                    <div class="glass-panel w-full p-6 rounded-[3rem] flex flex-col items-center">
                        <p class="text-sm text-gray-600 dark:text-gray-300 mb-4 text-center font-semibold">Ø§Ù†Ø¯Ø§Ø²Ù‡ Ø¯Ùˆ Ø²Ø§ÙˆÛŒÙ‡ Ø¯Ø§Ø®Ù„ÛŒ ØºÛŒØ±Ù…Ø¬Ø§ÙˆØ± Ø±Ø§ ÙˆØ§Ø±Ø¯ Ú©Ù†ÛŒØ¯:</p>
                        
                        <div class="flex gap-4 w-full justify-center">
                            <div class="flex flex-col items-center">
                                <label for="angle1" class="text-xs text-gray-500 mb-1">Ø²Ø§ÙˆÛŒÙ‡ Û± (Â°)</label>
                                <input id="angle1" type="number" min="0" max="180" step="1" class="glass-input w-20 h-12 text-2xl text-center rounded-xl font-mono text-gray-800" placeholder="A">
                            </div>
                            
                            <div class="flex flex-col items-center">
                                <label for="angle2" class="text-xs text-gray-500 mb-1">Ø²Ø§ÙˆÛŒÙ‡ Û² (Â°)</label>
                                <input id="angle2" type="number" min="0" max="180" step="1" class="glass-input w-20 h-12 text-2xl text-center rounded-xl font-mono text-gray-800" placeholder="B">
                            </div>
                        </div>
                    </div>

                    <button onclick="calcExteriorAngle()" class="btn-bubble btn-eq h-14 rounded-full text-xl font-semibold shadow-lg">Ù…Ø­Ø§Ø³Ø¨Ù‡ Ø²Ø§ÙˆÛŒÙ‡ Ø®Ø§Ø±Ø¬ÛŒ</button>

                    <div id="tri-result" class="glass-panel w-full min-h-[6rem] rounded-[2.5rem] flex items-center justify-center p-4">
                        <span class="text-center text-gray-500 dark:text-gray-300 text-sm">Ù†ØªÛŒØ¬Ù‡ Ø§ÛŒÙ†Ø¬Ø§ Ù†Ù…Ø§ÛŒØ´ Ø¯Ø§Ø¯Ù‡ Ù…ÛŒâ€ŒØ´ÙˆØ¯</span>
                    </div>
                </div>
            `;
        }

        function calcExteriorAngle() {
            const angle1 = parseFloat(document.getElementById('angle1').value);
            const angle2 = parseFloat(document.getElementById('angle2').value);
            const box = document.getElementById('tri-result');
            
            if (isNaN(angle1) || isNaN(angle2) || angle1 < 0 || angle2 < 0) {
                box.innerHTML = '<span class="text-center text-red-600 font-bold">Ù„Ø·ÙØ§Ù‹ Ø¯Ùˆ Ø²Ø§ÙˆÛŒÙ‡ Ù…Ø¹ØªØ¨Ø± ÙˆØ§Ø±Ø¯ Ú©Ù†ÛŒØ¯.</span>';
                return;
            }
            if (angle1 + angle2 >= 180) {
                 box.innerHTML = '<span class="text-center text-red-600 font-bold">Ù…Ø¬Ù…ÙˆØ¹ Ø²ÙˆØ§ÛŒØ§ Ø¨Ø§ÛŒØ¯ Ú©Ù…ØªØ± Ø§Ø² Û±Û¸Û° Ø¯Ø±Ø¬Ù‡ Ø¨Ø§Ø´Ø¯.</span>';
                return;
            }

            const exteriorAngle = angle1 + angle2;

            box.innerHTML = `
                <div class="flex flex-col items-center">
                    <span class="text-sm text-gray-600 dark:text-gray-300">Ø§Ù†Ø¯Ø§Ø²Ù‡ Ø²Ø§ÙˆÛŒÙ‡ Ø®Ø§Ø±Ø¬ÛŒ:</span>
                    <span class="text-4xl text-blue-700 dark:text-blue-400 font-bold font-mono mt-1">${exteriorAngle.toFixed(2)}Â°</span>
                </div>
            `;
        }
    </script>
</body>
</html>

